---
date: 2025-12-14
paper_title: "Physically-Motivated Force Fields from Symmetry-Adapted Perturbation Theory"
short_title: "SAPT 기반 Physically-Motivated Force Field 구축 방법론"
authors: "Jesse G. McDaniel; J. R. Schmidt*"
journal: "The Journal of Physical Chemistry A"
year: 2013
doi: "10.1021/jp3108182"
status: "first_read"
read_round: 1
tags: [SAPT,forcefield, ab-initio, intermolecular, dispersion, induction, MOF, virial]
category: "Force Field 개발 method"
relevance_to_my_work: "high"
project: "IL-MOF_OECT, IL-Oligomer"
file_ref: "https://doi.org/10.1021/jp3108182"
note_lang: "ko"
priority: "⭐️⭐️⭐️⭐️☆"
key_topics: ["physically-motivated force field", "SAPT energy decomposition", "transferable atomic parameters", "heteromolecular interactions", "MOF gas adsorption"]
key_methods: ["SAPT 기반 에너지 분해 항-대응 파라미터화", "표준 MD 패키지 호환 FF 구성", "2nd virial coefficient 검증"]
key_systems: ["small molecules (2nd virial)", "heteromolecular pairs", "functionalized MOF gas adsorption"]
---

# Physically-Motivated Force Fields from SAPT – Paper Note
![pasted image](_images/20251214_022044_147629.png)


## 1. 한 줄 요약 / 키 메시지
SAPT의 에너지 분해(SAPT decomposition) 항(교환/정전기/유도/분산 등)에 **1:1로 대응하는 힘장(FF) 항을 명시적으로 구성**하고, 각 항을 해당 SAPT 성분에 맞춰 파라미터화함으로써 **정확도·물리성·전이성(transferability)**을 동시에 확보하는 “physically-motivated” ab initio force field 생성 프레임워크를 제시한다.[1]


## 3. 논문 읽기

## ABSTRACT
우리는 대칭 적응 섭동 이론(SAPT) 프레임워크를 활용하여 **정확하고 전이 가능한(transferable) 제일원리(ab initio) 힘장(force field)**을 생성하기 위한 일반적 방법론을 제시한다. 본 방법으로 얻어진 힘장은 교환(exchange), 정전기(electrostatics), 유도(induction), 분산(dispersion)과 같은 다양한 근본 분자간 상호작용을 설명하기 위한 **서로 분리되고 명시적인 항(term)**을 포함한다는 점에서 “물리 기반(physically motivated)”이다. 또한 각 항은 SAPT 에너지 분해(SAPT energy decomposition)의 대응 성분에 대해 매개변수화된다. 결정적으로, 결과 힘장은 기존의 표준 시뮬레이션 패키지들과 대체로 호환되며, 구현을 위해 필요한 수정은 최소 수준에 그친다. 우리는 분자 환경 간 전이가 가능한 견고하고 물리적으로 의미 있는 원자 수준 매개변수를 산출하는 여러 새로운 매개변수화 기법을 제시한다. 또한 다양한 소분자에 대해 실험적 제2 비리얼 계수(second virial coefficients)와의 검증을 통해 본 방법의 정확성과 일반성을 입증한다. 이어서 물리적으로 타당한 가정식(ansatzes)을 이용해 이러한 원자 매개변수들을 조합함으로써 임의의 이종분자(heteromolecular) 상호작용 에너지를 정확히 예측할 수 있음을 보이며, 기능화된 금속–유기 골격체(MOF) 물질에서의 기체 흡착 예측을 포함한 적용 예를 제시한다.

---

## INTRODUCTION
고전적 분자동역학(MD) 시뮬레이션은 이제 순수 액체(neat liquids)부터 복잡한 벌크 고체, 생체분자 시스템에 이르기까지 다양한 복잡도의 계에 일상적으로 적용되고 있다. 이러한 시뮬레이션은 고전적 경험적 힘장(empirical force fields)과 결합될 때 구조·열역학·동역학에 대한 분자 수준의 관점을 제공한다. 그러나 이러한 시뮬레이션의 정확도와 신뢰성은 근본적으로 기반 힘장에 의해 좌우된다. 역사적으로 분자 간 힘장은 물리적 의미보다는 계산 편의에 의해 규정된 단순한 함수형(예: Lennard–Jones)에 지배되어 왔고, 기존 실험 데이터에 근거하여 경험적으로 매개변수화되어 왔다. 반면, 정확하고 전이 가능한 “차세대(next generation)” 힘장은 표준 Lennard–Jones 또는 Buckingham 형태를 넘어, 기술하려는 근본 물리 상호작용과 본질적으로 연결된 함수형을 포함해야 한다는 점이 일반적으로 받아들여지고 있다 [1–7]. 이상적으로 이러한 차세대 힘장은 엄밀한 제일원리 전자구조(즉, 제일원리 힘장)로부터 “도출 가능(derivable)”해야 하며, 경험적 매개변수화 및 그에 수반되는 기존 실험 데이터 의존성으로부터 자유로워야 한다. 그러나 정확한 퍼텐셜 에너지 표면(PES)을 구성하기 위한 고수준 양자화학 계산의 긴 역사에도 불구하고, 일반적이며 전이 가능한 힘장을 위한 대응 접근은 훨씬 제한적이었다. 이는 후자(전이 가능한 힘장)가 전이 가능성 자체로 인해 추가 제약을 도입하기 때문인데, 즉 다양한 근본 분자간 상호작용을 지배하는 매개변수들의 “물리성(physicality)”과 관련 함수형의 점근적(asymptotic) 정확성에 대한 제약이 그것이다. 이러한 배경에서 우리는 최근 대칭 적응 섭동 이론(SAPT)에 기반한 강력한 프레임워크를 개발하여 정확하고 “물리 기반”인 제일원리 힘장을 매개변수화할 수 있음을 보였다 [8]. 본 연구의 목적은 이러한 및 관련 발전을 간략히 검토한 뒤, 우리의 기존 방법론을 확장하여 다양한 분자 시스템과 환경에 일반적으로 적용 가능한 전이성 높은 차세대 힘장 매개변수를 생성할 수 있음을 보여주는 데 있다.

SAPT(그리고 보다 최근의 밀도범함수 이론 기반 SAPT, 즉 DFT-SAPT [9–20])는 이러한 힘장을 매개변수화하기 위한 강력한 틀을 제공한다. 전통적 경험적 힘장과 달리, 물리 기반 힘장은 분자 간 상호작용을 개별 에너지 성분들의 관점에서 기술하며, 각 성분은 그에 적합한 함수형으로 표현된다. 구체적으로 우리는 SAPT의 맥락에서 자연스럽게 등장하는 에너지 기여—교환(exchange), 정전기(electrostatic), 유도(induction), 분산(dispersion)—에 주목한다. 이들 성분은 각각 별도의 힘장 항으로 개별적으로 적합(fit)된다. 이러한 구성은 각 에너지 기여 사이의 올바른 균형을 보장하고, 허구적 오류 상쇄(spurious error cancellation)를 완화하며, 점근적으로 올바른 거동을 갖는 보다 견고한 힘장을 제공한다. 그러나 SAPT는 분자 수준의 상호작용 에너지를 제공하는 반면, 전이 가능한 힘장은 필연적으로 원자 수준의 상호작용 매개변수를 요구하므로, 분자 간 상호작용을 (대부분) 원자–원자 쌍(pairwise atom–atom) 상호작용으로 분할하는 것이 주요 도전 과제이다.

진전은 단량체(monomer) 성질을 활용함으로써 가능하다. 두 분자 사이의 장거리(long-range) 상호작용은 다중극자 모멘트(multipole moments) 및 정적/주파수 의존 분극률 텐서(static/frequency-dependent polarizability tensors)와 같은 단량체 매개변수만으로 완전히 기술될 수 있음이 잘 알려져 있다. 그러나 근거리(close range)에서는 단량체 전자밀도 겹침으로부터 발생하는 교환 반발(exchange repulsion)과 정전기적 전하 침투(electrostatic charge penetration) 효과가 분자간 상호작용을 추가로 특징짓는데, 이러한 효과는 단순히 단량체 성질만으로는 기술할 수 없다. 이에 Stone과 Misquitta는 장거리의 점근 상호작용 매개변수는 단량체 응답 계산(monomer response calculations)에 적합하고, 단거리 상호작용 매개변수는 이량체(dimer) SAPT 계산에 적합하는 절차를 제시하였다 [1]. 전자의 경우, 그들은 Stone의 분산 다중극자 해석(DMA)과 분산 원자 분극률(distributed atomic polarizabilities) 등(동일 저자들이 개척한 방법)을 이용하여 단량체 계산으로부터 필요한 원자 매개변수를 얻는다. 이러한 기여는 우리의 힘장 개발 방법론을 위한 중요한 출발점이 된다.

최근 여러 연구에서 우리는 SAPT 프레임워크 내에서 개발된 제일원리 힘장이 분자동역학(MD) 및 몬테카를로(MC) 시뮬레이션에 활용되어, 벌크 순수 유체부터 나노다공성 물질에서의 기체 흡착에 이르기까지 다양한 복잡도의 시스템에서 구조적·열역학적·동역학적 성질을 정확히 예측할 수 있음을 보였다 [21–24]. 예를 들어, 우리는 순수 CO2, N2 및 그 혼합물을 정확히 기술하는 “SYM” 힘장을 이전에 개발했으며, 이 힘장은 비리얼 계수(virial coefficients), 밀도, 액체 구조, 열용량, 확산 계수, 상 공존(phase coexistence) 등 폭넓은 열역학 데이터에 대해 광범위하게 벤치마킹되었다(그 결과가 Figure 1에 제시됨). 또한 다양한 토폴로지와 기능화(functionalization)를 갖는 제올라이트 이미다졸레이트 프레임워크(ZIF; 금속–유기 골격체의 한 종류)에서 CO2/N2 흡착을 정확히 기술하는 견고하고 전이 가능한 힘장 “ZIF FF”도 개발했으며, 그 결과는 Figure 2에 제시하였다. (참고: 등온선은 ref [24]에 제시된 값과 아주 약간 다르며, 이는 원래 보고된 매개변수 중 하나의 오류 때문이고 Supporting Information을 참조하라.)

**[Figure 1 삽입 위치]**
*Figure 1 캡션(번역):* “SYM” 힘장이 예측한 CO2의 공존 밀도(기호). 본 그림은 ref [21]에서 재인용됨. © 2011 American Chemical Society.

**[Figure 2 삽입 위치]**
*Figure 2 캡션(번역):* 298 K에서의 CO2 등온선. 실선은 실험 데이터 [25,26], 기호는 본 연구의 시뮬레이션 결과.

우리가 이미 보였고 본 논문에서 추가로 입증하겠지만, SAPT 기반 힘장 생성 접근과 그에 수반되는 물리 기반 힘장은 전통적 경험적 힘장에 비해 몇 가지 설득력 있는 장점을 제공한다. 첫째, 힘장은 제일원리 데이터에 적합되므로 어떤 경험적 매개변수화도 필요 없고, 따라서 사전 실험 데이터가 거의 없거나 전혀 없는 시스템에도 적용 가능하다. 둘째, 개별 에너지 성분을 명시적으로 분리함으로써 허구적 오류 상쇄를 완화하여 매개변수화의 견고성을 높이며, 각 근본 분자간 상호작용 유형을 기술하는 데 물리적으로 적절한 함수형을 사용할 수 있게 한다. 더 나아가, 이 방법론은 체계적이며 완전한 재매개변수화 없이도 명확한 개선 계층(hierarchy of improvements)을 제공한다. 또한 개별 성분 분리를 구성적으로(by construction) 내장하고 있으므로, 최종 힘장은 고전 시뮬레이션 중에도 활용 가능한 자연스러운 에너지 분해(energy decomposition)를 허용하며, 유한한 온도와 압력의 열역학적으로 관련된 조건에서 상호작용을 분석하는 데 이를 활용할 수 있다. 마지막으로, 결과 힘장은 정확할 뿐 아니라(그리고 본 논문에서 기술하는 수정들을 통해) 다양한 화학적·물리적 환경에 대해 탁월한 전이성을 가질 잠재력이 있다.

위에서 기술한 “물리 기반” 접근은 전례가 없었던 것은 아니며, 여러 관련 선행 접근과 대비해 보는 것이 유익하다. 선행 연구(및 본 연구) 전반에 걸친 공통 주제는 단량체 계산을 이용해 정전기 다중극자 및 정적/주파수 의존 분극률을 얻는다는 점이다. 여기서는 특히 이러한 분자 성질을 원자 매개변수로 분배(distribute)하는 데 사용되는 방법들에 초점을 맞춘다. 이러한 분배 스킴은 매개변수 전이성(또는 그 결여)의 핵심이며, 전이성은 본 논문의 중요한 강조점이다. 이러한 선행 접근들은 모두 어떤 형태로든 제일원리 에너지 분해(EDA) 방법을 매개변수화 및/또는 벤치마킹에 사용한다. 우리는 SAPT를 사용하지만, 섭동 이론이 아니라 변분적 초분자(supermolecular) 파동함수 계산에 기반한 다른 방법들도 사용되어 왔으며, 이에 대한 기술은 문헌을 참고하라 [27].

본 접근과 가까운 평행 사례로는 Gresh, Piquemal 등 공저자들의 SIBFA(sum of interactions between fragments ab initio computed) 접근이 있다 [3,6,28,29]. SIBFA는 총 상호작용 에너지를 다섯 성분—정전기(electrostatic), 반발(repulsion), 분극(polarization), 전하 이동(charge transfer), 분산(dispersion)—의 합으로 표현하도록 설계되었다. 각 에너지 성분을 기술하는 식은 비교적 복잡하며, 비등방 상호작용, 결합 및 비원자(off-atom) 상호작용 사이트, 궤도 의존적 반발 및 전하 이동 항 등을 포함한다. 점근 정전기 기술에는 DMA를 사용하고, Vigne-Maeder 및 Claverie의 방법을 이용하여 원자 및 결합 중심에 최대 사중극자(quadrupole) 차수까지의 다중극자를 분배한다 [30]. 분극 에너지 기여는 분산된 비등방 쌍극자 분극률 텐서(distributed anisotropic dipole polarizability tensors)를 사용해 계산된다. 이러한 분산 분극률은 Garmer와 Stevens의 절차 [31]로 생성되는데, 유한장(finite field) 응답 계산을 수행하고, 쌍극자 모멘트 연산자에 대한 필요한 기대값들을 국소화 분자 궤도(LMO)의 기여로 분할한다. SIBFA에서 반발 에너지는 분자 전자밀도 겹침에 대한 의존성이 결합과 고립전자쌍(lone pair) 기여의 합으로 표현될 수 있다는 가정식(ansatz)에 따라 구성되며, 따라서 궤도 겹침 적분과 점유수(occupation numbers)에 대한 근사식이 요구된다 [3]. SIBFA의 완전한 방법론 설명은 refs [3,6]에 제시되어 있다.

본 접근과 비교될 수 있는 또 다른 방법으로는 Gordon 등 공저자들의 유효 단편 퍼텐셜(EFP) 방법이 있다 [4,32–35]. EFP는 원래 QM/MM 적용을 위해 개발되었으며, 용매 환경을 QM 해밀토니안 내 1전자 “유효 단편(effective fragment)” 퍼텐셜로 표현한다. 그러나 EFP(보다 구체적으로는 더 새롭고 더 일반적인 EFP2 방법)는 고전 분자 시뮬레이션을 위한 “단독(stand alone)” 제일원리 힘장으로도 사용될 수 있으며, 이러한 관점에서 최근 연구는 SAPT 및 기타 고수준 제일원리 계산과의 비교를 통해 EFP의 정확도를 평가하였다 [36]. EFP에 내재된 에너지 분해는 본질적으로 SIBFA에서 사용되는 것과 동일하며, 즉 쿨롱(Coulomb), 유도(induction), 교환 반발(exchange repulsion), 분산(dispersion), 전하 이동(charge transfer) 성분의 합이다. 쿨롱 에너지는 Stone의 DMA 방법을 이용하여 원자 및 결합 중심에 최대 팔중극자(octopole)까지의 분산 다중극자 전개(distributed multipole expansions)로 모델링된다 [37,38]. 유도 에너지는 결합 및 고립전자쌍에 분산된 분극률 텐서를 사용하여 모델링되며, SIBFA와 같은 LMO 분배 스킴을 사용한다(상기 참조). 분산 에너지는 감쇠(damped)된 $C_6/R^6$ 및 $C_8/R^8$ 항으로 모델링되는데, 이는 결합 퍼텐셜 하트리–폭(CPHF) 수준에서 얻은 주파수 의존 분극률 텐서로부터 계산되며, 정적 텐서를 분배하는 데 사용되는 것과 동일한 LMO 스킴으로 분배된다. 마지막으로 교환 반발 에너지는 LMO 기저에서 분자 간 전자밀도 겹침(intermolecular electron density overlap)의 전개로 정식화된다.

SIBFA와 EFP는 모두 단량체 계산을 통해 점근 상호작용에 대한 정보를 추출하고, 단거리 반발 상호작용을 설명하기 위해 가정식(ansatz)에 의존한다. 한편 Beran 등 공저자들은 하이브리드 혼합 QM/MM 접근을 고안했는데, 여기서는 단거리 상호작용은 QM으로 처리하고, 장거리 상호작용은 제일원리 단량체 성질로부터 도출된 분극성 힘장으로 처리한다 [39,40]. 이 접근은 결정 다형(polymorph)의 격자 에너지(lattice energies)를 구분하는 데 성공적으로 사용되었다. 그러나 순수 고전 힘장으로 매핑되지 않은 채 명시적 QM 계산에 의존하므로, 유한 온도에서의 분자동역학/몬테카를로 시뮬레이션에 적용하기에는 계산 비용이 지나치게 커질 것이다.

SAPT(및 DFT-SAPT)는 관련된 모든 분자간 거리에서 유효한 QM 상호작용 에너지와 그에 수반되는 에너지 분해를 제공하는 또 하나의 엄밀한 경로를 제시한다. 더 나아가 DFT-SAPT는 덜 정확한 CPHF 대신 결합 퍼텐셜 콘–샴(CPKS) 단량체 응답 계산을 사용할 수 있게 하면서도, 방법론적 불일치를 도입하지 않는다 [12,15]. SAPT 에너지 분해를 활용한 제일원리 힘장 개발의 예로는 Misquitta 등 [5]의 연구가 있다. 그들은 점근 정전기를 기술하기 위해 DMA를 사용하고, 유도와 분산에 필요한 분산 정적 및 주파수 의존 분극률 텐서를 얻기 위해 Williams–Stone–Misquitta(WSM) 방법 [41]을 사용한다.

이러한 선행 접근들(특히 Misquitta와 Stone의 기존 연구)과 마찬가지로, 우리의 DFT-SAPT 기반 접근은 SAPT 에너지 분해와 단량체 성질을 활용하여 분자간 상호작용을 교환, 정전기, 분극(polarization), 분산과 같은 근본 상호작용 유형의 관점에서 근사한다. 그러나 본 연구를 동기화하는 중요한 차이점이 적어도 두 가지 있다. 첫째, 우리는 진정으로 “물리적(physical)”이며 전이 가능한 원자 수준의 교환, 분극, 분산 매개변수를 추출하기 위한 새로운 적합(fitting) 절차를 사용한다. 그 결과, 얻어진 힘장은 특정 매개변수화에 포함되지 않았던 새로운 분자 시스템과 환경으로도 전이 가능하다. 둘째, 우리는 각 상호작용 유형에 대해 물리 기반 함수형을 사용하지만, 이들 항의 합(즉 총 에너지)은 표준 분자동역학(MD) 또는 몬테카를로(MC) 시뮬레이션 패키지에서 사용되는 형태와 놀랍도록 유사하여, 적은(혹은 사소한) 변경만으로 구현을 가능하게 한다. 이 두 가지 수정의 결과로, 힘장은 구현 장벽이 낮으면서도 정확하고 견고하며 전이 가능하게 된다.

마지막으로, 많은 선행 분자간 퍼텐셜들이 SAPT에 기초해 유도되어 왔으며 종종 큰 성공을 거두었음을 언급한다 [2,42–46]. 그러나 Li 등 [43]의 연구를 제외하면, 이러한 퍼텐셜들은 명시적 에너지 분해를 포함하지 않으며 총 SAPT 상호작용 에너지에 대해 적합된다. 또한 많은 경우(특히 작은 시스템에서) 이러한 퍼텐셜들은 총 분자 상호작용 에너지를 6개의 강체 상대 좌표에 대한 전개로 표현하여 강체 상호작용을 다루도록 설계되었다 [42,44]. 따라서 앞서 도입한 용어를 따르면, 이는 일반적 시뮬레이션을 위한 전이 가능한 원자적 퍼텐셜이라기보다 PES에 더 가깝고, 그에 따른 방법론과 목표는 본 논문에서 제시하는 접근과 상당히 다르다. 더 큰 분자에 대해서는, 일부 SAPT 기반 퍼텐셜이 원자 쌍(pairwise) 기여로 구성된 함수형에 대해 적합되기도 했다 [2,45,46]. 그러나 적합 과정에서 원자 매개변수들을 분리(decouple)하기 위한 기법이 거의 사용되지 않았기 때문에, 이들 퍼텐셜은 매우 정확하더라도 매개변수화된 시스템 밖으로는 전이되지 않는다.

본 논문의 나머지 구성은 다음과 같다. 먼저 우리는 기존의 DFT-SAPT 기반 힘장 매개변수화 방법론을 간략히 검토한다. 이어서 분산을 포함한 전이 가능한 원자 상호작용 매개변수를 다양한 소분자와 작용기(functional groups)에 대해 얻기 위해 우리의 노력을 어떻게 확장할 수 있는지 보인다. 다음으로 알케인, 알켄, 아민, 알코올, 알데하이드, 케톤 등 다양한 소유기 분자에 대한 제2 비리얼 계수(second-virial coefficients)를 통해 이러한 힘장 매개변수를 벤치마킹한다. 마지막으로 우리는 특히 판별력이 높은 예시 적용을 통해 힘장 매개변수의 전이성을 시연하는데, 즉 IRMOF1(MOF5) 및 아민 기능화된 IR-MOF3를 포함한 금속–유기 골격체(MOF)에서의 이산화탄소(CO2) 흡착 등온선을 계산한다.

# ■ METHODOLOGY (방법론)

우리는 기존에 확립한 force field 개발 방법론을 간략히 요약한 뒤[21,23,24], **진정으로 물리적이며(physical) 전이 가능한(transferable) 원자 수준 파라미터**를 추출할 수 있도록 하는 몇 가지 개선점을 제시한다. 본 force field는 분자 간 상호작용을 구성하는 서로 다른 물리적 성분들을 분리된 항(term)으로 표현하며, 각 항은 SAPT(Symmetry-Adapted Perturbation Theory) 에너지 분해의 대응 성분과 짝을 이룬다.

우리의 force field에서 분자 간 총 상호작용 에너지는 다음과 같이 분해된다.

$$
E_{\mathrm{int}}^{\mathrm{FF}}
=
E_{\mathrm{elec}} + E_{\mathrm{exch}} + E_{\mathrm{pol}} + E_{\mathrm{disp}} + \delta E_{\mathrm{hf}}.
$$

각 성분은 SAPT 분해의 다음 항들과 대응된다.

$$
E_{\mathrm{elec}} \leftrightarrow E_{\mathrm{elec}}^{(1)} \tag{1}
$$

$$
E_{\mathrm{exch}} \leftrightarrow E_{\mathrm{exch}}^{(1)} \tag{1}
$$

$$
E_{\mathrm{pol}}
\leftrightarrow
E_{\mathrm{ind}}^{(2)} + E_{\mathrm{ind\text{-}exch}}^{(2)} \tag{2}
$$

$$
E_{\mathrm{disp}}
\leftrightarrow
E_{\mathrm{disp}}^{(2)} + E_{\mathrm{disp\text{-}exch}}^{(2)} \tag{2}
$$

여기서 우리는 흔히 사용되는 묶음(grouping),

$$
E_{\mathrm{pol}} = E_{\mathrm{ind}}^{(2)} + E_{\mathrm{ind\text{-}exch}}^{(2)},\qquad
E_{\mathrm{disp}} = E_{\mathrm{disp}}^{(2)} + E_{\mathrm{disp\text{-}exch}}^{(2)}
$$

을 채택한다.
 이는 (부분적으로) SAPT 에너지에서 **짧은 거리에서 인공적으로 발생하는 수학적 발산**이 서로 짝을 이루는 항들 사이에서 상쇄되기 때문이며, 이러한 상쇄 구조를 force field에서도 반영하기 위함이다.

아래에서는 각 에너지 성분을 구체적인 force field 항으로 근사하는 방식을 기술한다(표기상 \(\approx\) 또는 \(\simeq\)는 해당 항이 대응 물리량을 재현하도록 설계된 근사식을 의미한다).

---

## (i) Electrostatics (정전기)
\[
E_{\mathrm{elec}}
\;\approx\;
\sum_{i}\sum_{j}
\frac{q_i q_j}{r_{ij}}\, f_{1}(\lambda_{ij}, r_{ij})
\;+\;
\sum_{i}\sum_{j}
A_{ij}^{\mathrm{elec}} \exp\!\left(-B_{ij} r_{ij}\right).
\]

---

## (ii) Exchange-repulsion (교환-반발)
\[
E_{\mathrm{exch}}
\;\approx\;
\sum_{i}\sum_{j}
A_{ij}^{\mathrm{exch}} \exp\!\left(-B_{ij} r_{ij}\right).
\]

---

## (iii) Polarization / Induction (분극/유도)
\[
E_{\mathrm{pol}}
\;\approx\;
U_{\mathrm{shell}}
\;+\;
\sum_{i}\sum_{j}
A_{ij}^{\mathrm{ind}} \exp\!\left(-B_{ij} r_{ij}\right).
\]

---

## (iv) Dispersion (분산력)
\[
E_{\mathrm{disp}}
\;\approx\;
-
\sum_{i}\sum_{j}
\sum_{n=6,8,10,12}
f_{n}(\lambda_{ij}, r_{ij})\,
\frac{C_{n,ij}}{r_{ij}^{\,n}}.
\]

---

## (v) Higher-order / \(\delta E_{\mathrm{hf}}\) 항
\[
\delta E_{\mathrm{hf}}
\;\approx\;
\Delta E_{\mathrm{SCF}}
-
U_{\mathrm{shell}}
\;+\;
\sum_{i}\sum_{j}
A_{ij}^{\delta\mathrm{hf}}
\exp\!\left(-B_{ij} r_{ij}\right).
\]
위 항들을 모두 합하면 전체 포텐셜 에너지는 다음과 같은 형태로 쓸 수 있다.

$$
U_{\mathrm{tot}}
=
\sum_{i}\sum_{j}
\left[
\frac{q_i q_j}{r_{ij}}\, f_{1}(\lambda_{ij}, r_{ij})
+
A_{ij}^{\mathrm{elec}} e^{-B_{ij} r_{ij}}
+
A_{ij}^{\mathrm{exch}} e^{-B_{ij} r_{ij}}
-
\sum_{n=6,8,10,12}
f_n(\lambda_{ij}, r_{ij})\frac{C_{n,ij}}{r_{ij}^{\,n}}
\right]
+
U_{\mathrm{shell}}.
$$

여기서

$$
f_{n}(\lambda, r)
=
1 - e^{-\lambda r}\sum_{m=0}^{n}\frac{(\lambda r)^m}{m!}
$$

는 Tang–Toennies damping function이며[47], 정전기 및 분산 상호작용의 멀티폴 전개를 짧은 거리에서 완화(damp)하기 위해 사용된다. 또한

$$
U_{\mathrm{shell}}
=
U_{\mathrm{shell}}^{(2)}
+
U_{\mathrm{shell}}^{\Delta \mathrm{SCF}}.
$$

는 Drude oscillator에 기반한 총 분극 에너지로 정의된다[21,23]. 이 분극 에너지를 \(U_{\mathrm{shell}}^{(2)}\) 및 \(U_{\mathrm{shell}}^{\Delta \mathrm{SCF}}\)로 분해하는 구체적 논의는 뒤에서 다룬다. (damping 함수의 도입 및 더 높은 차수의 van der Waals 항을 추가한 점을 제외하면) 본 함수형은 많은 표준 MD/MC 시뮬레이션 패키지에서 사용되는 형태와 호환된다.

---

## 파라미터 추출 알고리즘 개요
우리는 ab initio 데이터에 기반하여 **견고하고 전이 가능한 force field 파라미터**를 추출하는 포괄적 알고리즘을 제시한다. 이전 연구에서 논의했듯이, 파라미터화는 두 단계로 분리한다.

1) 먼저 **단량체(monomer) 물성**으로부터 점근(asymptotic) 파라미터를 유도한다: 원자 전하(atomic charges), 정적 분극률(Drude oscillator charge로 표현), 그리고 분산 계수(dispersion coefficients).

2) 다음으로, 전하 밀도 중첩(overlap)에 의존하는 파라미터들,
$$
A_{ij}^{\mathrm{exch}},\; A_{ij}^{\mathrm{elec}},\; A_{ij}^{\mathrm{ind}},\; A_{ij}^{\delta\mathrm{hf}}
$$
을 적절한 dimer 시스템에 대한 DFT-SAPT 계산에 맞추어 적합(fit)한다.

지수항의 지수(exponent) \(B_{ij}\)는 모든 원소쌍에 대해 물리적 고려에 기반해 생성한다. 각 원소 \(i\)에 대해
$$
B_{ii} = 2\sqrt{2\,\mathrm{IP}_i}
$$
로 두며, 원소쌍 교차항은 다음 조합 규칙으로 만든다.

$$
B_{ij} = (B_i + B_j)\,\frac{B_i B_j}{B_i^2 + B_j^2}
$$

여기서 \(\mathrm{IP}_i\)는 해당 원소의 이온화 퍼텐셜(ionization potential)이며, 이 식의 동기는 선행 연구에서 상세히 설명하였다[24].

---

## 계산 수준 및 일관성(Consistency)
단량체 계산은 이상적으로 dimer DFT-SAPT 계산과 **일관된 수준의 이론**에서 수행되어야 한다. dimer SAPT 계산에 대해 우리는 이전에 PBE 함수[48](혹은 아래에서 논의하듯 PBE0)를 사용했으며, dimer 중심(dimer-centered)의 aug-cc-pVTZ(AVTZ) basis[49]에 midbond basis function을 추가한 조합을 채택하였다[21]. 대부분의 DFT 함수가 점근적으로 올바르지 못한 거동을 보이므로, 점근 보정(asymptotic corrections)[18,20]이 필수이며, 이를 위해 필요한 이온화 퍼텐셜은 AVTZ/PBE0 수준에서 계산한다. SAPT 계산은 MolPro 2009 패키지의 density fitting DFT-SAPT 구현을 이용하였다[50].

단량체와 dimer(SAPT) 계산 간 일관성을 유지하는 데 특히 어려운 지점은 **basis set 선택**이다. 이는 단량체 response 계산이 basis set에 강하게 의존하기 때문이다(반면, 원자 전하를 유도하는 DMA 계산은 basis set에 대해 빠르게 수렴한다). 이상적으로는 단량체 response 계산에도 SAPT dimer 계산에서 사용되는 midbond basis와 유사한 off-atom basis site를 포함하는 것이 바람직하다. SAPT에서 이러한 off-atom site는 확산된 전자밀도 꼬리(diffuse density tails)를 기술하는 데 효과적이며, 분자 response에 중요한 기여를 한다[41]. 그러나 단량체만 존재하는 상황에서는 off-atom site의 위치를 사전에 자명하게 정할 수 없으므로, 우리는 단량체 response 계산에 diffuse augmented dAVTZ basis[41]를 사용하고, 추가적인 basis set 보정을 뒤에서 설명하는 방식으로 적용한다.

---

# ■ MONOMER PROPERTIES (단량체 물성)

본 모델에서 정전기 상호작용은 **damping이 적용된 원자 점전하(damped atomic point charges)**로 다룬다. 점근 정전기 상호작용을 지배하는 원자 점전하는 다음 절차로 단량체로부터 계산한다. 먼저 PBE 또는 PBE0 함수와, 단량체 크기에 따라 double-ζ 혹은 triple-ζ basis set을 사용하여 계산된 단량체 전자밀도에 대해 DMA(Stone의 방법[37,38]) 표현을 얻는다. 우리는 DMA가 함수/기저 선택에 비교적 둔감함을 확인하였다. 원칙적으로 이 DMA 결과를 force field에 직접 사용할 수도 있으나[4,5,40], 표준 MD/MC 패키지에 보다 쉽게 적용 가능한 단순한 점전하 모델을 지향한다. 따라서 Ferenczy의 방법[51]을 적용하여 DMA로부터 얻은 전기적 퍼텐셜(ESP)을 재현하도록 원자 중심 점전하를 적합한다.

이 **2단계 절차(DMA → 점전하 ESP 적합)**는 전체 ESP에 점전하를 직접 적합하는 방법과 비교하여 뚜렷한 장점을 갖는다. 즉, 이 방법에서는 “각 사이트의 multipole에 의해 생성되는 ESP”로부터 “점전하가 재현해야 할 ESP”를 분리하여 적합하므로, 다른 ESP 적합법과 달리 **분자 내부에 ‘묻힌(buried)’ 원자들에 대해서도 물리적으로 타당한 전하**를 안정적으로 제공한다. Totton 등은 이러한 점전하 적합법이 다른 ESP 계열 접근보다 정확도와 전이성 측면에서 우수함을 보인 바 있다[52].

---

## 분극률 및 분산 파라미터
나머지 단량체 물성으로는 분포 정적 및 주파수 의존 분극률(distributed static/frequency-dependent polarizabilities)이 있으며, 여기서 각각 Drude oscillator 및 분산 파라미터를 얻는다[23,24]. 분포 분극률은 Williams–Stone 방법[41,53]의 새로운 확장으로부터 유도되는데, 이 방법은 점전하 섭동(point charge perturbations) 격자에 대해 선형 분자 response를 계산한다. 이러한 분자 response는 점근 보정된 PBE0 함수와 ALDAX + CHF 커널, 그리고 dAVTZ basis set을 사용하여 CPKS(coupled-perturbed Kohn–Sham) 수준에서 계산한다[24]. 우리는 CAMCASP 프로그램[41,54–56]을 이용해 response를 계산하며, CAMCASP 기본 격자점 개수 및 배치 설정을 사용한다. 전이 가능한 분포 분극률을 추출하기 위해, 우리는 Williams–Stone 방법을 **자기일관적(self-consistent) 반복 절차**로 확장하고, 상세는 아래에 기술한다.

Williams–Stone 방법은 격자점 \(P\)에 놓인 점전하 섭동에 의해 유도되는 선형 response가 만들어내는 격자점 \(Q\)에서의 ESP를 계산하고, 이를 국소적(local)·등방성(isotropic) 모델에 적합하는 방식에 기반한다. 본 논문에서는 다음과 같은 형태로 모델 response를 정의한다(참고문헌[53]의 더 일반식에서 수정).

$$
\tilde{\alpha}_{PQ}
=
-
\sum_{a}\sum_{t}
T^{0t}_{Pa}\,
\alpha^{t}_{a}\,
T^{t0}_{aQ}.
$$


여기서 \(T^{0t}_{Pa}\), \(T^{t0}_{aQ}\)는 정전기 상호작용 함수, \(\alpha_a^{t}\)는 적합할 분극률 텐서 성분, \(\tilde{\alpha}_{PQ}\)는 \(P,Q\) 격자점 사이의 response에 대한 모델 예측값을 의미한다[53]. 합은 모든 site \(a\) 및 지정한 rank까지의 텐서 성분 \(t\)에 대해 수행된다(등방성 모델이므로 rank마다 고유 성분은 하나만 존재한다는 점에 유의).

이 절차는 정적 및 주파수 의존 response 모두에 적용 가능하며, 각각 유도(induction) 및 분산(dispersion) 파라미터를 생성한다. 다만 정적 분극률에 적용할 때는 Drude oscillator가 점 쌍극자(point dipole)가 아니라 **유한 크기의 쌍극자**이며, oscillator들 사이에 분자 내부 상호작용(intramolecular interactions)이 존재한다는 점을 반영하기 위해 몇 가지 단순한 수정이 필요하다[21]. 주파수 의존 response의 경우 rank 3까지 적합하여 \(C_{12}\)까지의 분산 계수를 얻는 반면, 정적 response에서는 Drude oscillator 모델에 해당하는 rank 1 수준만 적합한다. 수소 원자의 경우 rank 3 주파수 의존 텐서는 적합하되, 원자 간 거리가 짧아 damping이 문제를 일으킬 수 있으므로 수소 원자에는 \(C_{12}\) 분산 계수를 포함하지 않는다. 이러한 수소의 “특수 처리”는 선행 연구에서도 사용된 바 있다[41]. \(C_{12}\)까지 포함하는 필요성에 대한 체계적 검토는 Misquitta와 Stone에 의해 수행되었다[41].

---

## 자기일관 반복(Iterative) 확장: 전이 가능한 원자 파라미터 “라이브러리”
우리는 유사한 작용기(functional group)를 공유하는 분자 “라이브러리”에 대해 point-to-point response를 적합하는 **자기일관 반복 확장**을 최근 보고한 바 있으며[24], 본 연구의 주요 목표 중 하나는 이 전략이 **견고한 전이형 원자 파라미터 집합**을 산출함을 보이는 것이다. 표준 Williams–Stone 절차를 무제약으로 적용하면 \(\alpha_a^t\)들 사이의 결합(coupling) 때문에 비물리적인 원자 파라미터가 나올 수 있으며[41], 이는 전이성을 크게 저해한다. 따라서 우리는 반복 적합의 각 단계에서 체계적인 제약(constraints)을 도입한다.

절차는 다음과 같다. 먼저 공통 작용기를 공유하는 분자 집합에 대해 정적 또는 주파수 의존 point-to-point response를 계산한다. 만약 해당 분자 집합에 기존에 이미 적합된 “라이브러리”의 atom type이 포함되어 있다면, 그 atom type의 분극률 텐서는 전체 적합 과정 동안 해당 라이브러리 값으로 고정한다. 다음으로 목표 atom type의 \(\alpha_a^t(\omega)\)에 대한 합리적인 초기값(0차 근사)은, 작은 단순 분자(예: 동핵 이원자 분자 등)에서 무제약 Williams–Stone 방법을 적용하여 얻는다(이 경우 표준 방법도 종종 타당한 값을 준다).

이후, 분자 집합 내 모든 분자에 대해 point-to-point response 적합을 반복 수행하는데, 각 분자는 개별적으로 적합하되 **각 반복(iteration)에서 오직 하나의 atom type만 자유롭게 적합**하고, 나머지 atom type은 이전 반복에서 얻은 값으로 고정한다. 한 번의 반복이 끝나면, 그 반복에서 적합된 atom type에 대한 새로운 \(\alpha_a^t(\omega)\)를 분자 집합 전체에 대해 평균내고, 이 평균값을 다음 반복에서 제약값으로 사용한다. 다음 반복에서는 다른 atom type을 목표로 선택하여 동일 절차를 반복한다. 이 과정을 모든 목표 atom type에 대해 순차적으로 반복하며 수렴할 때까지 진행한다.

<!-- ========================= -->
<!-- FIGURE 3 위치 (여기에 삽입) -->
<!-- ========================= -->
**[Figure 3 위치]**
*Figure 3. 원자 정적/주파수 의존 분극률을 얻기 위한 반복 적합 절차의 개략도.*
(그림 파일 경로 예시: `../images/figure3.png`)

---

우리는 위 반복 적합 절차를 세 가지 분자 컬렉션에 대해 수행하여, 여러 작용기 분산 파라미터를 획득하였다. 이들 컬렉션은 순차적으로 적합되며, 이전 컬렉션에서 얻은 파라미터는 atom type “라이브러리”에 추가되어 다음 컬렉션에서 제약으로 사용된다.

- 첫 번째 컬렉션: 선형/가지형/고리형을 포함한 23개 알케인·알켄. atom type은 수소, sp\(^3\) 탄소, sp\(^2\) 탄소의 3종만 사용.
- 두 번째 컬렉션: 알코올 및 1·2·3차 아민 24개 분자. 새 atom type은 알코올 산소, 아민 질소, 그리고 수소 결합성 N–H/O–H 수소(총 1종). 필요한 알케인/알켄 파라미터는 1차 컬렉션 결과로 제약.
- 세 번째 컬렉션: 산(acid)·케톤·알데하이드가 섞인 23개 분자. 새 atom type은 카보닐 탄소/산소 및 알데하이드 수소의 3종. 산의 O/H는 알코올에서 얻은 값으로 제약하고, 알케인/알켄/아민 제약은 이전 결과를 사용.

이렇게 얻어진 9개 atom type의 분극률 텐서 파라미터 “라이브러리”는 Supporting Information에 제시되어 있다. 원자 분산 파라미터는 이 주파수 의존 분극률 텐서를 이용한 수치적 적분(quadrature)으로부터 생성된다[41,53,57].

---

## 전이성 검증: 제약 적합 vs 무제약 적합
우리는 9-atom type “라이브러리”로 계산한 point-to-point response의 RMS 오차를 무제약(unconstrained) 적합과 비교하여, 파라미터의 정확도 및 전이성을 평가한다. 반복 절차는 추가 제약을 도입하므로 RMS 오차는 원리적으로 무제약 적합보다 커야 하며, 두 오차의 비율은 Supporting Information에 제공된다. 가장 작은 비영(非零) 주파수에 대해 평균 RMS 오차 비는 알케인/알켄, 알코올/아민, 산/케톤/알데하이드 세 컬렉션에서 각각 1.02, 1.02, 1.01로 나타났다. 이 비율이 1.0에 매우 가깝다는 사실은, atom type 정의가 화학적으로 타당하고 환경 간 전이 가능하며, 분자 response를 충실히 재현하는 동시에 물리적으로 의미 있는 전이형 파라미터를 강제하고 있음을 시사한다. 우리는 유사한 접근을 기능화된 imidazolate 유도체에도 적용한 바 있다[24].

---

## 분산의 basis set 보정 및 교차항 조합 규칙
분산 에너지는 basis set 크기에 대해 수렴이 느리며, 이것이 SAPT 계산에서 midbond basis function을 사용하는 주된 이유다[58]. 그러나 이러한 midbond 함수는 단량체 response 계산에는 존재하지 않기 때문에, 단량체 중심 dAVTZ 기반 SAPT 계산은 dimer 중심 AVTZ+midbond SAPT 계산만큼 basis set이 수렴되어 있지 않을 수 있다[41]. 우리는 선행 연구에서 imidazolate–CO\(_2\) dimer를 대상으로 이 효과를 시험하여, 단량체 중심 dAVTZ SAPT가 특정 configuration에서 분산을 최대 약 10% 과소평가함을 보였고, 분산 계수에 1.07의 스케일 팩터(“basis set correction”)를 적용했다[24]. 다만 그 분석은 방향족 분자에 기반해 과대 보정 가능성이 있으므로, 본 연구에서는 비방향족의 작은 dimer를 대표하는 ethane dimer를 다시 분석하였다. 그 결과 “basis set correction”은 약 1.03으로 평가되었고, 우리는 본 연구에서 단량체 response로부터 얻는 모든 분산 계수에 이 1.03 스케일을 적용한다.

마지막으로, \(C_6\)–\(C_{12}\) 교차항(cross term) 파라미터를 만들기 위한 조합 규칙을 논의한다. 원칙적으로 교차항은 원자 주파수 의존 분극률 텐서로부터 엄밀하게 계산 가능하며[41], 따라서 조합 규칙이 필수는 아니다. 그러나 엄밀 알고리즘은 매우 많은 파라미터와 다수의 수치적 적분을 요구하므로, 우리는 흔히 쓰이는 조합 규칙
$$
C_{n,ij}=\sqrt{C_{n,ii}C_{n,jj}}
$$
의 정확도를 검토하였다. Supporting Information에서 9개 atom type 사이의 가능한 모든 교차항에 대해 위 조합 규칙 결과를 “정확 계산값”과 비교한 결과, \(C_6, C_8, C_{10}, C_{12}\)의 평균 절대 오차는 각각 0.7%, 3%, 5%, 8%였다. 이 오차들은 방법론의 기대 정확도 범위 내이며 대부분 비체계적(nonsystematic)으로 나타났으므로, 우리는 단순화의 이점을 고려해 이를 수용 가능하다고 판단하였다. 따라서 본 연구의 나머지 전 과정에서는 위 조합 규칙을 사용한다.

---
