{% extends "base.html" %}

{% block title %}Dashboard - Research Platform{% endblock %}

{% block content %}
<div class="dashboard-page">
    <!-- Page Header -->
    <div class="page-header">
        <h1>Welcome back, {{ user.display_name or user.username }}</h1>
        <p class="subtitle">Your research workspace</p>
        <div class="header-actions">
            <button class="btn btn-primary" id="new-doc-btn">
                <i class="ri-add-line"></i>
                <span>New Document</span>
            </button>
            <button class="btn btn-secondary" id="import-btn">
                <i class="ri-upload-2-line"></i>
                <span>Import</span>
            </button>
        </div>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon blue"><i class="ri-file-text-line"></i></div>
            <div class="stat-value" id="stat-documents">0</div>
            <div class="stat-label">Documents</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon green"><i class="ri-folders-line"></i></div>
            <div class="stat-value" id="stat-workspaces">0</div>
            <div class="stat-label">Workspaces</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon yellow"><i class="ri-star-line"></i></div>
            <div class="stat-value" id="stat-favorites">0</div>
            <div class="stat-label">Favorites</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon purple"><i class="ri-team-line"></i></div>
            <div class="stat-value" id="stat-collaborators">0</div>
            <div class="stat-label">Collaborators</div>
        </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid">
        <!-- Recent Documents -->
        <div>
            <div class="section-title">
                <h3>Recent Documents</h3>
                <a href="{{ root_path }}/recent" class="view-all">View all</a>
            </div>
            <div class="doc-list" id="recent-documents">
                <div class="empty-state">
                    <i class="ri-file-text-line"></i>
                    <span>No recent documents</span>
                </div>
            </div>
        </div>

        <!-- Favorites -->
        <div>
            <div class="section-title">
                <h3>Favorites</h3>
                <a href="{{ root_path }}/favorites" class="view-all">View all</a>
            </div>
            <div class="doc-list" id="favorite-documents">
                <div class="empty-state">
                    <i class="ri-star-line"></i>
                    <span>No favorites yet</span>
                </div>
            </div>
        </div>

        <!-- Activity -->
        <div>
            <div class="section-title">
                <h3>Activity</h3>
            </div>
            <div class="activity-list" id="activity-feed">
                <div class="empty-state">
                    <i class="ri-time-line"></i>
                    <span>No activity yet</span>
                </div>
            </div>
        </div>

        <!-- Quick Links -->
        <div>
            <div class="section-title">
                <h3>Quick Links</h3>
            </div>
            <div class="quick-links">
                <a href="{{ root_path }}/help" class="quick-link">
                    <i class="ri-question-line"></i>
                    <span>Help & Guide</span>
                </a>
                <a href="javascript:void(0)" class="quick-link" id="shortcuts-link">
                    <i class="ri-keyboard-line"></i>
                    <span>Keyboard Shortcuts</span>
                </a>
                <a href="javascript:void(0)" class="quick-link" id="feedback-link">
                    <i class="ri-feedback-line"></i>
                    <span>Send Feedback</span>
                </a>
                <a href="{{ root_path }}/settings" class="quick-link">
                    <i class="ri-settings-3-line"></i>
                    <span>Settings</span>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- New Document Modal -->
<div class="modal" id="new-doc-modal">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Create New Document</h3>
            <button class="modal-close" onclick="this.closest('.modal').classList.remove('active')">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="modal-body">
            <form id="new-doc-form">
                <div class="form-group">
                    <label for="doc-title">Title</label>
                    <input type="text" id="doc-title" placeholder="Untitled" autofocus>
                </div>
                <div class="form-group">
                    <label for="doc-workspace">Workspace</label>
                    <select id="doc-workspace"></select>
                </div>
                <div class="form-group">
                    <label>Template</label>
                    <div class="template-grid">
                        <label class="template-option">
                            <input type="radio" name="template" value="blank" checked>
                            <div class="template-card">
                                <i class="ri-file-line"></i>
                                <span>Blank</span>
                            </div>
                        </label>
                        <label class="template-option">
                            <input type="radio" name="template" value="meeting">
                            <div class="template-card">
                                <i class="ri-calendar-event-line"></i>
                                <span>Meeting</span>
                            </div>
                        </label>
                        <label class="template-option">
                            <input type="radio" name="template" value="experiment">
                            <div class="template-card">
                                <i class="ri-flask-line"></i>
                                <span>Experiment</span>
                            </div>
                        </label>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="this.closest('.modal').classList.remove('active')">Cancel</button>
            <button class="btn btn-primary" id="create-doc-btn">Create</button>
        </div>
    </div>
</div>

<!-- Import Modal -->
<div class="modal" id="import-modal">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Import Document</h3>
            <button class="modal-close" onclick="this.closest('.modal').classList.remove('active')">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="import-workspace">Workspace</label>
                <select id="import-workspace"></select>
            </div>
            <div class="upload-zone" id="import-zone" style="border: 2px dashed var(--border-color); border-radius: var(--radius-lg); padding: 40px; text-align: center; cursor: pointer;">
                <i class="ri-upload-cloud-line" style="font-size: 2.5rem; color: var(--text-muted); display: block; margin-bottom: 8px;"></i>
                <p style="color: var(--text-secondary); font-size: var(--font-size-sm);">Drag & drop Markdown files here, or click to browse</p>
                <p style="color: var(--text-muted); font-size: var(--font-size-xs); margin-top: 4px;">Supports .md, .txt files</p>
                <input type="file" id="import-file" accept=".md,.txt,.markdown" hidden multiple>
            </div>
        </div>
    </div>
</div>

<!-- Feedback Modal -->
<div class="modal" id="feedback-modal">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Send Feedback</h3>
            <button class="modal-close" onclick="this.closest('.modal').classList.remove('active')">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="feedback-type-grid">
                <button class="feedback-type-btn active" data-type="general">
                    <i class="ri-chat-smile-line"></i>
                    <span>General</span>
                </button>
                <button class="feedback-type-btn" data-type="bug">
                    <i class="ri-bug-line"></i>
                    <span>Bug</span>
                </button>
                <button class="feedback-type-btn" data-type="feature">
                    <i class="ri-lightbulb-line"></i>
                    <span>Feature</span>
                </button>
                <button class="feedback-type-btn" data-type="other">
                    <i class="ri-more-line"></i>
                    <span>Other</span>
                </button>
            </div>
            <form id="feedback-form">
                <div class="form-group">
                    <label for="feedback-title">Title</label>
                    <input type="text" id="feedback-title" placeholder="Brief summary" required>
                </div>
                <div class="form-group">
                    <label for="feedback-message">Message</label>
                    <textarea id="feedback-message" rows="4" placeholder="Describe your feedback..." required></textarea>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="this.closest('.modal').classList.remove('active')">Cancel</button>
            <button class="btn btn-primary" id="submit-feedback-btn">Send Feedback</button>
        </div>
    </div>
</div>

<!-- Shortcuts Modal -->
<div class="modal" id="shortcuts-modal">
    <div class="modal-backdrop"></div>
    <div class="modal-content modal-lg">
        <div class="modal-header">
            <h3>Keyboard Shortcuts</h3>
            <button class="modal-close" onclick="this.closest('.modal').classList.remove('active')">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="shortcuts-grid" id="shortcuts-grid"></div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ root_path }}/static/js/dashboard.js"></script>
{% endblock %}
