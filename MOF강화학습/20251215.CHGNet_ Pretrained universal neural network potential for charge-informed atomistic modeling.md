---
date: "2024-05-23"
paper_title: "CHGNet: Pretrained universal neural network potential for charge-informed atomistic modeling"
short_title: "전하 정보를 포함한 원자 모델링을 위한 CHGNet"
authors: "Bowen Deng, Peichen Zhong, KyuJung Jun, Janosh Riebesell, Kevin Han, Christopher J. Bartel, Gerbrand Ceder"
journal: "arXiv:2302.14231v2 [cond-mat.mtrl-sci]"
year: 2023
status: "translated"
tags: [Machine Learning, Interatomic Potential, Graph Neural Network, Battery Materials, Molecular Dynamics]
category: "Research"
summary: "본 연구는 전하 정보를 포함하여 원자 모델링을 수행할 수 있는 범용 그래프 신경망 포텐셜인 CHGNet을 제안합니다. Materials Project의 방대한 DFT 궤적 데이터로 사전 학습된 CHGNet은 자기 모멘트를 통해 원자 전하 상태를 학습하며, 리튬 이온 배터리 소재 등의 상전이 및 이온 확산 연구에서 우수한 성능을 입증했습니다."
file_ref: "CHGNet_Paper.pdf"
---

<!-- Page 1 -->

# CHGNet: 전하 정보를 포함한 원자 모델링을 위한 사전 학습된 범용 신경망 포텐셜
(CHGNet: Pretrained universal neural network potential for charge-informed atomistic modeling)

**Bowen Deng,¹² Peichen Zhong,¹²* KyuJung Jun,¹² Janosh Riebesell,²³ Kevin Han,² Christopher J. Bartel,¹⁴ and Gerbrand Ceder¹²†**

¹Department of Materials Science and Engineering, University of California, Berkeley, California 94720, United States
²Materials Sciences Division, Lawrence Berkeley National Laboratory, California 94720, United States
³Cavendish Laboratory, University of Cambridge, United Kingdom
⁴Department of Chemical Engineering and Materials Science, University of Minnesota, Minneapolis, Minnesota 55455, United States

(날짜: 2023년 6월 22일)

**요약**
복잡한 전자 상호작용을 가진 대규모 시스템의 시뮬레이션은 재료의 원자 모델링에서 가장 큰 과제 중 하나로 남아 있습니다. 고전적인 힘장(force fields)은 전자 상태와 이온 재배열 간의 결합을 설명하는 데 종종 실패하는 반면, 더 정확한 제일원리 분자 동역학(ab-initio molecular dynamics)은 계산 복잡성으로 인해 반응, 이온 이동, 상전이 및 열화와 같은 기술적으로 관련된 많은 현상을 연구하는 데 필수적인 장시간 및 대규모 시뮬레이션을 수행하지 못합니다.
본 연구에서는 범용 포텐셜 에너지 표면(potential energy surface)을 모델링하기 위해 그래프 신경망 기반 힘장을 사용하는 새로운 머신러닝 원자 간 포텐셜(MLIP)로서 Crystal Hamiltonian Graph neural Network (CHGNet)를 제시합니다. CHGNet은 Materials Project Trajectory Dataset의 에너지, 힘, 응력 및 자기 모멘트(magnetic moments)에 대해 사전 학습되었습니다. 이 데이터셋은 약 150만 개의 무기 구조에 대한 10년 이상의 밀도 범함수 이론(DFT) 정적 및 이완 궤적으로 구성됩니다. 자기 모멘트의 명시적 포함은 CHGNet이 전자의 오비탈 점유(orbital occupancy)를 학습하고 정확하게 표현할 수 있게 하여 원자 및 전자 자유도를 모두 설명하는 능력을 향상시킵니다. 우리는 $\text{Li}_x\text{MnO}_2$의 전하 정보 기반 분자 동역학, $\text{Li}_x\text{FePO}_4$의 유한 온도 상 다이어그램, 가넷(garnet) 전도체에서의 Li 확산을 포함하여 고체 재료에서 CHGNet의 여러 응용 사례를 시연합니다. 우리는 적절한 화학을 포착하기 위해 전하 정보를 포함하는 것의 중요성을 비판적으로 분석하고, 이전 MLIP로는 관찰할 수 없었던 추가적인 전자 자유도를 가진 이온 시스템에 대한 새로운 통찰력을 제공합니다.

---

## I. 서론 (INTRODUCTION)

분자 동역학(MD)과 같은 대규모 시뮬레이션은 고체 재료의 계산적 탐구에 필수적인 도구입니다 [1]. 이를 통해 반응성, 열화, 계면 반응, 부분적으로 무질서한 구조에서의 수송, 그리고 기술적으로 복잡한 재료의 응용과 관련된 기타 이질적인 현상을 연구할 수 있습니다. 이러한 시뮬레이션의 기술적 타당성은 원자의 오비탈 점유에서 비롯되는 엄격한 화학적 특이성을 요구합니다. 그 중요성에도 불구하고, MD 시뮬레이션에서 전자 상호작용이나 그 미묘한 효과를 정확하게 모델링하는 것은 여전히 주요 과제입니다. 고전적인 힘장은 전하를 모든 원자에 선험적(*a-priori*)으로 할당되는 원자 속성으로 취급합니다 [2, 3]. 전기음성도 평형화 방법(EEM) [4], 화학 포텐셜 평형화(CPE) [5], 전하 평형화(Qeq) [6]와 같은 분극 가능한 힘장 분야의 방법론 개발은 원자 부분 전하의 재분배를 통해 전하 진화를 실현합니다. 그러나 이러한 경험적 방법은 복잡한 전자 상호작용을 포착하기에 충분히 정확하지 않은 경우가 많습니다.

밀도 범함수 이론(DFT)을 사용한 제일원리 분자 동역학(AIMD)은 밀도 범함수 근사 내에서 전자 구조를 명시적으로 계산하여 양자 역학적 정확도로 높은 신뢰도의 결과를 생성할 수 있습니다. 전하 밀도 분포와 해당 에너지는 Kohn-Sham 방정식을 풀어서 얻을 수 있습니다 [7]. 이온 이동, 상전이 및 화학 반응을 연구하는 데 중요한 장시간 및 대규모 스핀 분극 AIMD 시뮬레이션은 어렵고 계산 집약적입니다 [8, 9]. 이러한 어려움은 중요한 현상을 모델링하는 데 필요한 충분한 시간 및 길이 규모에서 전하를 띤 이온과 그들의 오비탈 점유를 설명할 수 있는 더 효율적인 계산 방법의 필요성을 강조합니다.

ænet [10, 11] 및 DeepMD [12]와 같은 머신러닝 원자 간 포텐셜(MLIP)은 값비싼 전자 구조 방법과 효율적인 고전적 원자 간 포텐셜 사이의 격차를 해소할 수 있는 유망한 솔루션을 제공했습니다. 구체적으로, DimeNet [13], NequIP [14], TeaNet [15], MACE [16]와 같은 그래프 신경망(GNN) 기반 MLIP는 그래프 합성곱(graph convolution)을 통해 불변/등변(invariant/equivariant) 대칭 제약 조건과 장거리 상호작용을 통합하여 최첨단 성능을 달성하는 것으로 나타났습니다 [17]. 가장 최근에는 주기율표 전체에 대해 훈련된 GNN 기반 MLIP(예: M3GNet)가

<!-- Page 2 -->

각각의 새로운 응용 분야에 대해 화학별 훈련이 필요하지 않을 수 있는 범용 원자 간 포텐셜의 가능성을 보여주었습니다 [18–20]. 그러나 원자가(valence)가 화학 결합에 미치는 중요한 효과를 포함하는 것은 MLIP의 과제로 남아 있으며, 초기 성공은 주로 장거리 상호작용을 위한 정전기학의 포함에서 비롯되었습니다 [21–23].

이온 원자가의 중요성은 이온이 전자 수에 따라 주변 환경과 매우 다른 결합을 할 수 있다는 사실에서 비롯됩니다. 전통적인 MLIP는 원소 레이블을 기본 화학적 정체성으로 취급하지만, 전이 금속 이온의 서로 다른 원자가 상태는 서로 다른 원소만큼이나 다르게 행동합니다. 예를 들어, 고스핀 $\text{Mn}^{4+}$는 거의 항상 산소 원자에 의한 팔면체 배위에 존재하는 비결합 구형 이온인 반면, $\text{Mn}^{3+}$는 환경을 급격하게 왜곡하는 얀-텔러(Jahn–Teller) 활성 이온이며, $\text{Mn}^{2+}$는 사면체 배위를 강하게 선호하는 이온입니다 [8]. 거의 모든 전이 금속 이온에 대해 서로 다른 원자가 상태에 걸쳐 이러한 강력한 화학적 상호작용 변동성이 존재하며, 이는 화학적 정체성 이상의 이온 사양을 요구합니다. 또한, 전하 상태는 구성 엔트로피를 생성할 수 있는 자유도이며, 그 동적 최적화는 전하와 이온 운동의 강력한 결합으로 이어질 수 있는데, 이는 원소 레이블만 지닌 MLIP로는 포착할 수 없습니다. 명시적인 전자 물리학의 관련성은 전하 정보가 내장된 강력한 MLIP 모델의 개발을 동기 부여합니다.

전하는 단순한 산화수 레이블부터 양자 역학에서 유도된 연속 파동 함수에 이르기까지 다양한 방식으로 표현되어 왔습니다 [24]. MLIP에 전하 정보를 통합하는 데 있어 어려움은 표현의 모호성 [25], 해석의 복잡성 [26], 레이블의 부족 [22], 그리고 전하를 입력으로 취하는 것의 비실용성($E(\{r_i\}, \{q_i\})$, 여기서 레이블 $\{q_i\}$는 일반적으로 선험적으로 이용 가능하지 않음) [21] 등 많은 요인에서 발생합니다. 본 연구에서는 전하를 자기 모멘트(magmoms)의 포함으로부터 추론할 수 있는 원자 속성(원자 전하)으로 정의합니다. 우리는 사이트별 자기 모멘트를 전하 상태 제약 조건으로 명시적으로 통합함으로써

**그림 1. CHGNet 모델 아키텍처**
(a) CHGNet 워크플로: 알려지지 않은 원자 전하를 가진 결정 구조가 입력으로 사용되어 에너지, 힘, 응력 및 자기 모멘트를 예측하고, 결과적으로 전하가 장식된(charge-decorated) 구조를 생성합니다.
(b) 원자 그래프(Atom graph): 원자 간에 쌍별 결합 정보가 그려집니다; 결합 그래프(Bond graph): 결합 간에 쌍별 각도 정보가 그려집니다.
(c) 그래프는 기저 확장(basis expansions) 및 임베딩 레이어를 거쳐 원자, 결합, 각도 특징(features)을 생성합니다. 특징들은 여러 상호작용 블록을 통해 업데이트되며, 속성은 출력 레이어에서 예측됩니다.
(d) 원자, 결합, 각도가 정보를 공유하고 업데이트하는 상호작용 블록.
(e) 이웃 원자 및 결합 정보가 가중 메시지 전달을 통해 계산되고 원자로 집계되는 원자 합성곱(Atom convolution) 레이어.

<!-- Page 3 -->

Crystal Hamiltonian Graph neural-Network (CHGNet)에 통합함으로써 잠재 공간(latent-space) 정규화를 강화하고 전자 상호작용을 정확하게 포착할 수 있음을 보여줍니다.

우리는 $\text{Na}_2\text{V}_2(\text{PO}_4)_3$에서 원자 전하의 전하 제약 및 잠재 공간 정규화를 시연하고, $\text{Li}_x\text{MnO}_2$의 전하 이동 및 상전이 연구, $\text{Li}_x\text{FePO}_4$ 상 다이어그램의 전자 엔트로피, 그리고 가넷형 리튬 초이온 전도체 $\text{Li}_{3+x}\text{La}_3\text{Te}_2\text{O}_{12}$의 리튬 확산 연구에 CHGNet을 적용한 사례를 보여줍니다. CHGNet 구축에 전하 정보를 포함하는 것의 중요성을 비판적으로 비교하고 평가함으로써, 우리는 추가적인 전자 자유도를 가진 이온 시스템의 재료 모델링에 대한 새로운 통찰력을 제공합니다. 우리의 분석은 고체 재료의 원자 시뮬레이션에서 전하 정보가 수행하는 필수적인 역할을 강조합니다.

## II. 결과 (RESULTS)

### A. CHGNet 아키텍처 (CHGNet architecture)

CHGNet의 기초는 그림 1과 같은 GNN으로, 그래프 합성곱 레이어를 사용하여 엣지 $\{e_{ij}\}$로 연결된 노드 $\{v_i\}$ 집합을 통해 원자 정보를 전파합니다. 병진, 회전 및 순열 불변성은 GNN에서 보존됩니다 [27–29]. 그림 1(a)는 알려지지 않은 원자 전하를 가진 결정 구조를 입력으로 받아 해당 에너지, 힘, 응력 및 자기 모멘트를 출력하는 CHGNet의 워크플로를 보여줍니다. 전하가 장식된 구조는 온사이트(on-site) 자기 모멘트와 원자 오비탈 이론에서 추론할 수 있습니다. 자세한 내용은 다음 섹션에서 설명합니다.

CHGNet에서 주기적 결정 구조는 기본 셀(primitive cell)의 각 원자 $v_i$의 $r_{\text{cut}}$ 내에 있는 이웃 원자 $v_j$를 검색하여 원자 그래프 $G^a$로 변환됩니다. 엣지 $e_{ij}$는 그림 1(b)와 같이 $v_i$와 $v_j$ 사이의 쌍별 거리 정보로 그려집니다. 3체(Three-body) 상호작용은 보조 결합 그래프 $G^b$를 사용하여 계산할 수 있으며, 이는 결합 $e_{ij}$와 $e_{jk}$ 사이의 각도 $a_{ijk}$를 쌍별 정보로 취하여 유사하게 구성할 수 있습니다 (방법 참조). 우리는 다른 최근 GNN MLIP [13, 18, 30]와 유사한 접근 방식을 채택하여 각도/3체 정보를 포함합니다.

그림 1(c)는 기저 확장, 임베딩, 상호작용 블록 및 출력 레이어의 시퀀스로 구성된 CHGNet의 아키텍처를 보여줍니다 (자세한 내용은 방법 참조). 그림 1(d)는 상호작용 블록 내의 구성 요소를 보여주며, 여기서 원자 상호작용은 합성곱 레이어를 통한 원자, 결합 및 각도 특징의 업데이트로 시뮬레이션됩니다. 그림 1(e)는 원자 그래프의 합성곱 레이어를 나타냅니다. 가중 메시지 전달(Weighted message passing)은 원자 간에 정보를 전파하는 데 사용되며, 노드 $j$에서 노드 $i$로의 메시지 가중치 $\tilde{e}^a_{ij}$는 그래프 컷오프 반경에서 0으로 감소하여 포텐셜 에너지 표면의 매끄러움을 보장합니다 [13].

업데이트된 원자 특징 $\{v^n_i\}$ ($n$번의 합성곱 레이어 후)가 에너지를 예측하는 데 직접 사용되는 다른 GNN과 달리, CHGNet은 $n-1$ 합성곱 레이어의 노드별 특징 $\{v^{n-1}_i\}$가 자기 모멘트에 대한 정보를 포함하도록 정규화합니다. 정규화된 특징 $\{v^{n-1}_i\}$는 국소 이온 환경과 전하 분포 모두에 대한 풍부한 정보를 전달합니다. 따라서 에너지, 힘 및 응력을 예측하는 데 사용되는 원자 특징 $\{v^n_i\}$는 전하 상태 정보에 의해 전하 제약(charge-constrained)을 받습니다. 결과적으로 CHGNet은 핵 위치와 원자 정체성만을 입력으로 사용하여 전하 상태 정보를 제공할 수 있어 원자 모델링에서 전하 분포 연구를 가능하게 합니다.

### B. Materials Project 궤적 데이터셋 (Materials Project Trajectory Dataset)

Materials Project 데이터베이스는 94개 원소로 구성된 약 146,000개의 무기 재료에 대한 방대한 DFT 계산 컬렉션을 포함합니다 [31]. 범용 포텐셜 에너지 표면을 정확하게 샘플링하기 위해, 우리는 일반화 구배 근사(GGA) 또는 GGA+$U$ 교환-상관(Methods 참조)을 사용하여 구조 이완 및 정적 계산의 약 137만 개 Materials Project 작업을 추출했습니다. 이러한 노력의 결과로 1,580,395개의 원자 구성, 1,580,395개의 에너지, 7,944,833개의 자기 모멘트, 49,295,660개의 힘, 14,223,555개의 응력을 포함하는 포괄적인 데이터셋이 생성되었습니다. MPtrj 데이터셋 내 에너지의 일관성을 보장하기 위해 Wang 등 [32]이 설명한 대로 GGA/GGA+$U$ 혼합 호환성 보정을 적용했습니다.

MPtrj 데이터셋의 원소 분포는 그림 2에 나와 있습니다. 원소 상자의 왼쪽 아래 삼각형(따뜻한 색)은 데이터셋에서 해당 원소의 발생 빈도를 나타내며, 오른쪽 위 삼각형(차가운 색)은 해당 원소에 대한 자기 정보가 사용 가능한 인스턴스 수를 나타냅니다. 60개의 서로 다른 원소에 대해 100,000회 이상의 발생과 76개의 서로 다른 원소에 대해 10,000회 이상의 자기 정보 인스턴스를 보유한 MPtrj 데이터셋은 비활성 기체와 악티늄족을 제외한 모든 화학 물질에 대한 포괄적인 커버리지를 제공합니다. 그림 2의 하단 상자는 MPtrj 데이터셋의 에너지, 힘, 응력 및 자기 모멘트의 개수와 평균 절대 편차를 보여줍니다.

### C. 성능 평가 (Performance Evaluation)

400,438개의 학습 가능한 파라미터를 가진 CHGNet은 MPtrj 데이터셋에서 재료별로 분할된 8:1:1의 훈련, 검증 및 테스트 세트 비율로 훈련되었습니다 (방법 참조). MPtrj 테스트 세트 구조에 대한 에너지, 힘, 응력 및 자기 모멘트의 평균 절대 오차 통계는 표 I에 나와 있습니다. 우리는 자기 모멘트로 훈련된 모델에서 약간의 개선과 함께 유사한 테스트 세트 오차를 관찰합니다.

범용 힘장으로서 CHGNet의 견고성을 평가하기 위해, 우리는 분포 외(out-of-distribution) 재료 안정성 예측을 위해 Matbench Discovery [33]에 CHGNet을 제출했습니다.

<!-- Page 4 -->

**그림 2. Materials Project Trajectory (MPtrj) 데이터셋의 원소 분포.**
왼쪽 아래 삼각형의 색상은 원소의 총 원자/이온 수를 나타냅니다. 오른쪽 위 삼각형의 색상은 MPtrj 데이터셋에서 원자/이온이 자기 모멘트 레이블과 함께 통합된 횟수를 나타냅니다. 플롯의 하단 부분에는 에너지, 자기 모멘트, 힘 및 응력의 개수와 평균 절대 편차(MAD)가 있습니다.

CHGNet은 작성 시점에 이 벤치마크에 제출된 다른 8개 모델과 비교하여 고효율 안정 무기 결정 발견에서 최첨단 성능을 달성했습니다.

CHGNet 분자 동역학 시뮬레이션에 대한 벤치마크를 위해, 이전에 AIMD로 보고된 리튬 초이온 전도체에 대한 MD 시뮬레이션에 사전 학습된 CHGNet을 적용했습니다 [34]. 보충 그림 1은 CHGNet이 AIMD 오차 범위 내에서 상온 전도도 및 활성화 에너지에 대해 AIMD 결과와 체계적으로 일치하며, CHGNet이 DFT로 식별된 더 빠른 전도체와 더 느린 전도체를 성공적으로 구별함을 보여줍니다.

**표 I. 14,572개 재료의 157,955개 구조로 구성된 MPtrj 테스트 세트에 대한 CHGNet의 평균 절대 오차(MAE).**
'With mag'와 'No mag'는 모델이 자기 모멘트로 훈련되었는지 여부를 나타냅니다 ($\mu_B$는 보어 마그네톤).

| | Energy<br>(meV/atom) | Force<br>(meV/Å) | Stress<br>(GPa) | Magmom<br>($\mu_B$) |
|---|---|---|---|---|
| **With mag** | 30 | 77 | 0.348 | 0.032 |
| **No mag** | 33 | 79 | 0.351 | N/A |

### D. 자기 모멘트로부터의 전하 제약 및 전하 추론 (Charge-constraints and charge-inference from magnetic moments)

이종 원자가(heterovalent) 이온을 포함하는 고체 재료에서는 이온의 원자 전하를 구별하는 것이 중요합니다.

<!-- Page 5 -->

원소와 환경의 상호작용은 원자가 상태에 따라 크게 달라질 수 있기 때문입니다. 이종 원자가 이온의 원자가는 DFT 전하 밀도를 통해 직접 계산할 수 없다는 것이 잘 알려져 있는데, 이는 이웃 리간드 이온과의 혼성 이동(hybridization shift)으로 인해 전하 밀도가 원자가 상태에 거의 불변하기 때문입니다 [35, 36]. 또한 전체 전하 밀도의 정확한 표현 및 인코딩은 상당한 계산 자원을 필요로 하는 또 다른 까다로운 작업입니다 [26, 37]. 확립된 접근 방식은 주어진 원자 사이트의 자기 모멘트를 원자 전하의 지표로 의존하는 것인데, 이는 스핀 분극 DFT 계산에서 국소 업-스핀 및 다운-스핀 전자 밀도의 차이에서 유도될 수 있습니다 [8, 38]. 전하 밀도를 직접 사용하는 것과 비교할 때, 자기 모멘트는 이전 연구에서 입증된 바와 같이 전자 오비탈 점유 및 따라서 이온의 화학적 거동에 관한 더 포괄적인 정보를 포함하는 것으로 밝혀졌습니다.

원자 전하 처리를 합리화하기 위해, 우리는 예시로 NASICON 유형의 Na-이온 양극 재료인 $\text{Na}_4\text{V}_2(\text{PO}_4)_3$를 사용했습니다. (탈)삽입된 재료 $\text{Na}_{4-x}\text{V}_2(\text{PO}_4)_3$의 상 안정성은 Na/공공(vacancy) 정렬과 관련이 있으며 바나듐 사이트의 전하 정렬과 높은 상관관계가 있습니다 [39]. 우리는 2268개의 원자를 가진 $\text{Na}_4\text{V}_2(\text{PO}_4)_3$의 슈퍼셀 구조를 생성하고 Na 이온의 절반을 무작위로 제거하여 $\text{Na}_2\text{V}_2(\text{PO}_4)_3$ 조성의 구조를 생성했습니다. 여기서 V 이온의 절반은 $\text{V}^{4+}$ 상태로 산화됩니다. 우리는 CHGNet을 사용하여 (탈)삽입된 구조를 이완하고 이온 이완과 함께 V 원자의 원자가 상태를 구별하는 능력을 분석했습니다 (방법 참조).

그림 3(a)는 이완되지 않은(파란색) 구조와 이완된(주황색) 구조의 모든 V 이온에 대해 예측된 자기 모멘트의 분포를 보여줍니다. V 핵의 공간적 배위로부터 학습하는 것 외에 V-이온 전하 분포에 대한 사전 지식 없이도, CHGNet은 V 이온을 $\text{V}^{3+}$와 $\text{V}^{4+}$의 두 그룹으로 성공적으로 구별했습니다. 그림 3(b)는 세 개의 상호작용 블록 후 이완되지 않은 구조와 이완된 구조 모두에 대한 V 이온의 잠재 공간 특징 벡터의 2차원 주성분 분석(PCA)을 보여줍니다. PCA 분석은 잘 분리된 두 개의 분포를 보여주며, 이는 V 이온의 잠재 공간 특징 벡터가 V의 서로 다른 원자가 상태와 강하게 상관관계가 있음을 나타냅니다. 따라서 잠재 공간에 서로 다른 자기 모멘트 레이블을 부과하는 것(즉, 그림 3(a)의 두 주황색 피크가 빨간색 점선으로 수렴하도록 강제하는 것)은 잠재 공간 특징을 정규화함으로써 모델에 대한 *전하 제약(charge constraints)*으로 작용할 것입니다.

에너지, 힘 및 응력은 동일한 특징 벡터에서 계산되므로, 자기 모멘트의 포함은 서로 다른 국소 화학 환경(예: $\text{V}^{3+}$와 $\text{V}^{4+}$는 매우 뚜렷한 물리 및 화학을 나타냄)에 있는 이종 원자가 원자의 특징화를 개선하고 따라서 CHGNet의 정확도와 표현력을 향상시킬 수 있습니다.

**그림 3. $\text{Na}_2\text{V}_2(\text{PO}_4)_3$에서의 자기 모멘트 및 은닉 공간 정규화.**
(a) 이완되지 않은 구조(파란색)와 CHGNet으로 이완된 구조(주황색)에서 216개 V 이온의 자기 모멘트 분포.
(b) 자기 모멘트 투영 레이어 이전의 V-이온 임베딩 벡터에 대한 PCA의 2차원 시각화는 잠재 공간 클러스터링이 자기 모멘트 및 전하 정보와 높은 상관관계가 있음을 나타냅니다. PCA 축소는 이완되지 않은 구조와 이완된 구조 모두에 대해 계산됩니다.

### E. $\text{Li}_x\text{MnO}_2$ 상전이에서의 전하 불균등화 (Charge disproportionation in $\text{Li}_x\text{MnO}_2$ phase transformation)

CHGNet의 장시간 및 대규모 시뮬레이션은 전하 이동과 결합된 이온 재배열 연구를 가능하게 하며 [40, 41], 이는 이온 이동성과 이온 종 간의 상호작용을 정확하게 표현하는 데 중요합니다. 예를 들어, $\text{LiMnO}_2$ 배터리 양극 재료에서 전이 금속 이동은 상전이에서 중심적인 역할을 하며, 이는 비가역적인 용량 손실을 유발합니다 [42, 43]. Mn 이동 메커니즘은 전하 이동과 강하게 결합되어 있으며, $\text{Mn}^{4+}$는 움직이지 않는 이온인 반면, $\text{Mn}^{3+}$와 $\text{Mn}^{2+}$는 일반적으로 더 이동성이 높은 것으로 간주됩니다 [44–46]. 전자 자유도와 이온 자유도의 결합 역학은 연구하기 어려웠지만 사방정계 $\text{LiMnO}_2$ ($o$-LMO, 그림 4(a) 참조)에서 스피넬 $\text{LiMnO}_2$ ($s$-LMO)로의 상전이를 이해하는 데 중요합니다. 이러한 현상의 시간 규모와 계산 비용은 가능한 모든 제일원리 방법을 훨씬 뛰어넘기 때문입니다.

초기 준정적(quasi-static) 제일원리 연구에서 Reed 등 [40]은 전하 불균등화 메커니즘을 사용하여 상온에서 상전이가 진행되는 놀라운 속도를 합리화했습니다: $2\text{Mn}^{3+}_{\text{oct}} \rightarrow \text{Mn}^{2+}_{\text{tet}} + \text{Mn}^{4+}_{\text{oct}}$, 여기서 아래첨자는 그림 4(a)와 같이 면심 입방 산소 패킹의 사면체 또는 팔면체 사이트 위치를 나타냅니다. DFT 계산에 기반한 가설은 $\text{Mn}^{2+}$가 사면체와 팔면체 사이트 간의 이동에 대해 더 낮은 에너지 장벽을 가지며 사면체 사이트를 점유하는 것을 선호한다는 것이었습니다. 따라서 Mn이 원자가를 동적으로 변경할 수 있는 능력은 놀라운 상온 이동성을 설명할 수 있습니다. 그러나 Jang 등 [44]은 이후의 자기 특성 실험에서 전기화학적으로 변환된 스피넬 $\text{LiMnO}_2$가 사면체 사이트에 더 낮은 스핀(높은 원자가) Mn 이온을 가지고 있음을 보여주었으며, 이는 더 높은 원자가를 가진 Mn이

<!-- Page 6 -->

상전이 동안 사면체 사이트에서 안정적일 수 있는 가능성을 시사했습니다.

CHGNet이 이러한 과정을 완전히 설명할 수 있는 능력을 입증하기 위해, 우리는 CHGNet을 사용하여 1100 K에서 1.5 ns 동안 전하 정보 기반 MD 시뮬레이션을 실행했습니다 (방법 참조). MD 시뮬레이션은 $o$-LMO 구조($\text{Li}_{20}\text{Mn}_{40}\text{O}_{80}$)를 가진 부분적으로 탈리튬화된 슈퍼셀 구조에서 시작되었으며, 이는 X선 회절(XRD) 패턴에서 15°, 26°, 40°의 피크로 특징지어집니다 (그림 4(b)의 맨 아래 선). 시뮬레이션이 진행됨에 따라 사방정계 정렬에서 스피넬 유사 정렬로의 상전이가 관찰되었습니다. 그림 4(b)는

**그림 4. $\text{Li}_{0.5}\text{MnO}_2$ 상전이 및 전하 불균등화.**
(a) 사면체 사이트와 팔면체 사이트가 표시된 사방정계 $\text{LiMnO}_2$ ($o$-LMO) 단위 셀.
(b) 시스템이 $o$-LMO 상에서 $s$-LMO로 변환될 때 CHGNet MD 구조의 시뮬레이션된 XRD 패턴.
(c) 시간에 따른 사면체 및 팔면체 Mn 이온의 평균 자기 모멘트.
(d) 위: 시간에 따른 총 포텐셜 에너지 및 $o$-LMO와 $s$-LMO 특성 피크의 상대 강도. 검은색 실선은 10 ps마다 평균화된 것입니다. 아래: 시간에 따른 모든 Mn 이온의 자기 모멘트 히스토그램. 더 밝은 색상은 해당 자기 모멘트에 더 많은 Mn 이온이 분포되어 있음을 나타냅니다.
(e) GGA+$U$-DFT(검은색)와 CHGNet(파란색)을 사용하여 예측된 사면체 Mn 이온의 자기 모멘트. 구조는 0.4 ns(왼쪽) 및 1.5 ns(오른쪽)의 MD 시뮬레이션에서 가져왔습니다.

0에서 1.5 ns까지 다양한 시간 간격에서 MD 구조의 시뮬레이션된 XRD 패턴을 보여주며, 특징적인 스피넬 피크(18°, 35°)의 명확한 증가와 사방정계 피크의 감소를 보여줍니다. 시뮬레이션 결과는 실험적 *in-situ* XRD 결과와 잘 일치합니다 [42, 44].

그림 4(d)는 시뮬레이션 시간의 함수로서 LMO 슈퍼셀 구조의 CHGNet 예측 에너지와 $2\theta = 15^\circ$ 및 $18^\circ$에서의 피크 강도를 보여줍니다. 구조적 변환과 에너지 랜드스케이프 사이의 명시적인 상관관계가 관찰됩니다. 스피넬 상의 예측된 평균 포텐셜 에너지는 시작

<!-- Page 7 -->

$o$-LMO보다 약 50 meV/oxygen 낮아, 스피넬로의 상전이가 실제로 열역학적으로 유리함을 시사합니다.

CHGNet의 장점은 그림 4(d)의 아래쪽 플롯에서 입증된 바와 같이 전하 결합 물리학을 예측하는 능력에서 나타납니다. 구조 내 모든 Mn 이온의 자기 모멘트 히스토그램이 시간에 대해 제시됩니다. 시뮬레이션 초기에는 Mn 이온의 자기 모멘트가 대부분 $3\mu_B$와 $4\mu_B$ 사이에 분포하며, 이는 $\text{Mn}^{4+}$와 $\text{Mn}^{3+}$에 해당합니다. 약 0.8 ns에서 $\text{Mn}^{2+}$ 양의 상당한 증가가 있으며, 이는 포텐셜 에너지의 감소 및 XRD 피크의 변화를 동반합니다. 이 주요 변환 지점 이후, $\text{Mn}^{3+}$ 이온은 전하 불균등화를 겪어 변환된 스피넬 유사 구조에서 $\text{Mn}^{2+}$, $\text{Mn}^{3+}$, $\text{Mn}^{4+}$가 공존하게 됩니다.

장시간 전하 정보 기반 MD 시뮬레이션에서 얻은 중요한 관찰 중 하나는 이온 재배열과 전하 상태 진화 간의 상관관계입니다. 구체적으로, 우리는 전하 불균등화의 시간 규모($\text{Mn}^{2+}$ 출현에 약 ns)가 이온 홉(hop)의 시간 규모($\text{Mn}_{\text{tet}}$ 출현에 약 ps)보다 훨씬 길다는 것을 알게 되었으며, 이는 Mn의 사면체 배위로의 이동이 $\text{Mn}^{2+}$의 출현과 관련이 적음을 나타냅니다. 대신, 우리의 결과는 $\text{Mn}^{2+}_{\text{tet}}$의 출현이 장거리 스피넬 유사 정렬의 형성과 상관관계가 있음을 나타냅니다. 그림 4(c)는 시간에 따른 $\text{Mn}_{\text{tet}}$와 $\text{Mn}_{\text{oct}}$의 평균 자기 모멘트를 보여줍니다. 결과는 $\text{Mn}^{2+}_{\text{tet}}$가 오랜 기간에 걸쳐서만 형성됨을 보여주며, 이는 기존의 시뮬레이션 기술로는 관찰할 수 없습니다.

이 가설과 CHGNet 예측의 정확성을 추가로 검증하기 위해, 우리는 GGA+$U$ 및 r²SCAN-DFT(보충 정보 참조) 정적 계산을 사용하여 0.4 및 1.5 ns에서의 구조의 자기 모멘트를 얻었으며, GGA+$U$ 결과는 그림 4(e)에 나와 있습니다. CHGNet(파란색)은 GGA+$U$ 자기 모멘트(검은색)와 매우 정확한 일치를 보여주며 동일한 $\text{Mn}_{\text{tet}}$ 원자가 상태를 추론합니다.

### F. $\text{Li}_x\text{FePO}_4$ 상 다이어그램에서의 전자 엔트로피 효과 (Electronic entropy effect in the phase diagram of $\text{Li}_x\text{FePO}_4$)

구성 전자 엔트로피(configurational electronic entropy)는 혼합 원자가 산화물의 온도 의존적 상 안정성에 상당한 영향을 미치므로, 그 평형 모델링은 원자 전하의 명시적 표시를 필요로 합니다. 그러나 현재의 어떤 MLIP도 그러한 정보를 제공할 수 없습니다. 우리는 CHGNet을 사용하여 원자 전하를 추론하고 $\text{Li}_x\text{FePO}_4$의 온도 의존적 상 다이어그램(PD) 계산에 전자 엔트로피를 포함할 수 있음을 보여줍니다.

이전 연구에서는 $\text{Li}_x\text{FePO}_4$에서 고용체(solid solution)의 형성이 $\text{Li}^+$/공공 구성 엔트로피보다는 주로 전자 엔트로피에 의해 주도된다는 것을 보여주었습니다 [47]. 우리는 CHGNet을 에너지 계산기로 적용하여 두 개의 별도 클러스터 확장(CE)을 생성했습니다. 이는 구성

**그림 5. CHGNet을 이용한 $\text{Li}_x\text{FePO}_4$ 상 다이어그램.**
(a)와 (b)의 상 다이어그램은 $\text{Fe}^{2+}$ 및 $\text{Fe}^{3+}$에 대한 전자 엔트로피를 포함하거나 포함하지 않고 계산되었습니다. 색칠된 점은 준-대정준(semi-grand canonical) MC에서 얻은 안정상을 나타냅니다. 점선은 고용체 상 간의 2상 평형을 나타냅니다.

엔트로피를 연구하는 일반적인 접근 방식입니다 [48]. 이 중 하나는 전하 장식(charge-decorated, $\text{Li}^+$/공공 및 $\text{Fe}^{2+}$/$\text{Fe}^{3+}$ 고려)이고 다른 하나는 비전하 장식(non-charge-decorated, Fe 원자가 고려 없이 $\text{Li}^+$/공공만 고려)입니다. 준-대정준 몬테카를로(Semi-grand canonical Monte Carlo)를 사용하여 이러한 클러스터 확장을 샘플링하고 $\text{Li}_x\text{FePO}_4$ PD를 구성했습니다 (방법 참조). 그림 5(a)의 전하 장식으로 계산된 PD는 $\text{FePO}_4$와 $\text{LiFePO}_4$ 사이의 혼화성 갭(miscibility gap)을 특징으로 하며, 중간 Li 농도에서 고용체 상으로의 공석(eutectoid) 유사 전이를 보여주어 실험 결과와 질적으로 일치합니다 [49, 50]. 대조적으로, 그림 5(b)의 전하 장식 없이 계산된 PD는 공석 전이 없이 단일 혼화성 갭만을 특징으로 하여 실험과 불일치합니다. 이 비교는 전자 자유도의 명시적 포함의 중요성을 강조하며, 이를 수행하지 않으면 잘못된 물리학을 초래할 수 있습니다. 이러한 실험은 실무자가 구성적으로나 전자적으로 무질서한 시스템의 평형 모델링을 위해 원자 전하 추론이 포함된 CHGNet으로부터 어떤 이점을 얻을 수 있는지 보여줍니다.

### G. $\text{Li}_3\text{La}_3\text{Te}_2\text{O}_{12}$에서의 활성화된 Li 확산 네트워크 (Activated Li diffusion network in $\text{Li}_3\text{La}_3\text{Te}_2\text{O}_{12}$)

이 섹션에서는 범용 MD를 위한 CHGNet의 정밀도를 보여줍니다. 빠른 Li 이온 전도체에서의 리튬 이온 확산도는 조성 변화에 대해 급격한 비선형 반응을 보이는 것으로 알려져 있습니다. 예를 들어, 화학양론적 조성에 소량의 과잉 리튬을 채워 넣으면

<!-- Page 8 -->

**그림 6. 가넷 $\text{Li}_3\text{La}_3\text{Te}_2\text{O}_{12}$에서의 Li 확산도.**
CHGNet 시뮬레이션은 소량의 추가 Li가 가넷 구조에 채워질 때 Li 이온 확산도의 급격한 증가를 정확하게 재현하며, 활성화된 확산 네트워크 이론과 질적으로 일치하고 DFT 계산 활성화 에너지와 잘 일치합니다.

이온 전도도가 수십 배 향상될 수 있습니다 [34]. Xiao 등 [51]은 화학양론적 가넷 $\text{Li}_3\text{La}_3\text{Te}_2\text{O}_{12}$의 Li 확산 활성화 에너지가 1 eV 이상에서 약간 채워진 $\text{Li}_{3+\delta}$ 가넷($\delta = 1/48$)에서 약 160 meV로 감소한다고 보고했는데, 이는 면 공유 사면체 및 팔면체 사이트의 활성화된 Li 확산 네트워크 때문입니다.

우리는 확산도와 활성화 에너지에 대한 이러한 미세한 조성 변화의 효과를 포착하는 CHGNet의 능력을 평가하기 위해 제로 샷(zero-shot) 테스트를 수행했습니다. 그림 6은 CHGNet 기반 MD 시뮬레이션의 아레니우스(Arrhenius) 플롯을 보여주며 이를 AIMD 결과와 비교합니다. 우리의 결과는 활성화된 확산 네트워크 효과가 정확하게 포착되었을 뿐만 아니라, CHGNet의 활성화 에너지도 DFT 결과와 훌륭하게 일치함을 나타냅니다 [51]. 이 노력은 활성화된 국소 환경에서 Li 이온 간의 강한 상호작용을 정확하게 포착하고 매우 비선형적인 확산 거동을 시뮬레이션하는 CHGNet의 능력을 보여줍니다. 또한, CHGNet은 시뮬레이션된 확산도의 오차를 획기적으로 줄일 수 있으며 나노초 규모의 시뮬레이션으로 확장하여 채워지지 않은 $\text{Li}_3$ 가넷과 같이 확산도가 낮은 시스템에 대한 연구를 가능하게 합니다 [52].

## III. 토의 (DISCUSSION)

대규모 계산 모델링은 재료 과학, 의학 및 분자 생물학에서 원자 수준의 정보를 제공하는 데 필수적인 것으로 입증되었습니다. 기술적으로 관련된 많은 응용 분야에는 이종 원자가 종이 포함되어 있으며, 프로세스 역학에 관련된 원자 전하에 대한 포괄적인 이해가 큰 관심을 받고 있습니다. 이온에 원자가를 할당하는 것의 중요성은 전자 수가 변할 때 이온이 나타낼 수 있는 근본적으로 다른 전자 및 결합 거동에서 비롯됩니다. DFT에 기반한 제일원리 계산은 이러한 문제에 유용하지만, $\sim O(N^3)$ 스케일링은 본질적으로 장시간 및 대규모 스케일에 대한 적용을 금지합니다. 최근 MLIP의 개발은 DFT에 가까운 정확도를 유지하면서 계산 효율성을 높일 수 있는 새로운 기회를 제공합니다. 본 연구는 계산 효율성과 함께 전자 자유도를 포함해야 할 필요성을 결합한 MLIP를 제시합니다.

이 연구에서 우리는 CHGNet을 개발하고 원자 시뮬레이션에서 원자 전하를 추론하기 위한 대리자(proxy)로서 자기 모멘트를 통합하는 것의 효과를 입증했습니다. 이는 전자 정보의 통합과 MLIP의 정규화로서 추가적인 전하 제약의 부과를 초래합니다. 우리는 $\text{Li}_x\text{FePO}_4$ 연구에서 $\text{Fe}^{2+}$/$\text{Fe}^{3+}$를 구별하는 CHGNet의 능력을 강조하며, 이는 전자 엔트로피 및 유한 온도 상 안정성을 포함하는 데 필수적입니다. $\text{LiMnO}_2$ 연구에서 우리는 장시간 전하 정보 기반 MD로부터 이종 원자가 전이 금속 산화물 시스템의 전하 불균등화와 상전이 사이의 관계에 대한 새로운 통찰력을 얻는 CHGNet의 능력을 보여줍니다.

CHGNet은 그래프 기반 MLIP의 최근 발전 [13, 18]을 기반으로 하지만 전자 자유도가 내장된 상태로 사전 학습되어, 고엔트로피 재료를 포함한 다양한 기술적으로 관련된 산화물의 고효율 스크리닝 및 원자 모델링을 위한 이상적인 솔루션을 제공합니다 [53, 54]. CHGNet은 이미 사전 학습 중에 광범위한 화학으로 일반화되었으므로, 특정 화학에 대한 미세 조정(fine-tuning)으로 보강될 때 고정밀 시뮬레이션을 위한 데이터 효율적인 모델로도 사용될 수 있습니다.

이러한 발전에도 불구하고 몇 가지 노력을 통해 추가적인 개선을 달성할 수 있습니다. 첫째, 원자가 상태 추론을 위해 자기 모멘트를 사용하는 것은 전체 전하 중성을 엄격하게 보장하지 않습니다. 공식적인 원자가 할당은 원자 전하가 어떻게 분할되는지에 따라 달라집니다 [24]. 둘째, 자기 모멘트는 이온 시스템의 스핀 분극 계산에서 원자 전하에 대한 좋은 경험적 방법이지만, 비자성 이온에 대한 원자 전하 추론은 모호할 수 있으므로 추가적인 도메인 지식이 필요하다는 것이 인식되고 있습니다. 결과적으로 자기 모멘트가 없는 이온의 경우, 원자 중심 자기 모멘트는 원자 전하를 정확하게 반영할 수 없으며 CHGNet은 다른 MLIP의 기능과 유사하게 환경에서 전하를 추론할 것입니다. 전자 국소화 함수(electron localization function) [55], 전기 분극(electric polarization) [56], 원자 오비탈 기반 분할(예: Wannier 함수 [57])과 같은 전하 표현에 대한 다른 접근 방식을 통합하여 모델을 더욱 향상시킬 수도 있습니다. 이러한 접근 방식은 잠재 공간에서 원자 특징 엔지니어링에 사용될 수 있습니다.

결론적으로, CHGNet은 전하 정보 기반 원자

<!-- Page 9 -->

시뮬레이션을 가능하게 하여 대규모 계산 시뮬레이션을 사용하여 이종 원자가 시스템을 연구할 수 있게 하며, 계산 화학, 물리학, 생물학 및 재료 과학에서 전하 이동 결합 현상을 연구할 기회를 확장합니다.

## IV. 감사의 말 (ACKNOWLEDGMENTS)

이 연구는 미국 에너지부(DOE), 과학국, 기초 에너지 과학국, 재료 과학 및 공학부의 계약 번호 DE-AC0205CH11231 (Materials Project 프로그램 KC23MP)에 따라 자금 지원을 받았습니다. 이 연구는 또한 Extreme Science and Engineering Discovery Environment (XSEDE)에서 제공하는 계산 자원(미국 국립과학재단 보조금 번호 ACI1053575 지원), 로렌스 버클리 국립 연구소에 위치한 미국 에너지부 과학국 사용자 시설인 국립 에너지 연구 과학 컴퓨팅 센터(NERSC), 그리고 로렌스 버클리 국립 연구소의 IT 부서에서 제공하는 Lawrencium 계산 클러스터 자원의 지원을 받았습니다. 저자들은 또한 유용한 토론을 해준 Jason Munro와 Luis Barroso-Luque에게 감사를 표합니다.

## V. 방법 (METHODS)

### A. 데이터 파싱 (Data parsing)

Materials Project Trajectory Dataset (MPtrj)은 2022년 9월 Materials Project 데이터베이스 버전에서 파싱되었습니다. 우리는 각 material-id 아래의 모든 GGA 및 GGA+$U$ 작업 궤적을 수집하고 아래 기준을 따랐습니다:

1.  더 이상 사용되지 않는(deprecated) 작업은 제거하고 기본 작업과 동일한 계산 설정을 가진 작업만 유지하여 Materials Project 웹사이트에서 재료를 검색할 수 있도록 했습니다. 계산 설정이 동일한지 확인하기 위해 다음을 확인했습니다: (1) +$U$ 설정은 기본 작업과 동일해야 합니다. (2) 최종 프레임의 에너지는 기본 작업과 20 meV/atom 이상 차이가 나지 않아야 합니다.
2.  에너지 및 힘 또는 전자 단계 수렴이 없는 구조는 제거되었습니다.
3.  Materials Project의 ThermoDoc에서 이완된 구조에 비해 에너지가 1 eV/atom보다 높거나 10 meV/atom보다 낮은 구조는 VASP 설정의 변화 등으로 인한 큰 에너지 차이를 제거하기 위해 필터링되었습니다.
4.  건전한 데이터 분포를 유지하기 위해 중복 구조가 제거되었습니다. 이 제거는 `pymatgen StructureMatcher`와 구조 간의 차이를 구별하기 위한 에너지 매처(energy matcher)를 사용하여 달성되었습니다. 동일한 materials-id 아래에 더 많은 구조가 MPtrj 데이터셋에 추가됨에 따라 구조 및 에너지 매처의 스크리닝 기준이 더 엄격해졌습니다.

MPtrj 데이터셋의 훈련, 검증 및 테스트 세트는 145,923개의 화합물(mp-id 기준)을 기반으로 무작위로 선택되었습니다. 결과적으로, 서로 다른 DFT 작업과 그 궤적 프레임은 화합물에 따라 동일한 세트에만 포함될 수 있습니다.

### B. 모델 설계 (Model design)

결정 그래프를 구성할 때 기본 $r_{\text{cut}}$은 5Å로 설정되었으며, 이는 장거리 상호작용을 포착하기에 충분한 것으로 나타났습니다 [18]. 결합 그래프는 계산 효율성을 위해 3Å의 컷오프로 구성됩니다. 결합 거리 $r_{ij}$는 Gasteiger 등 [13]이 제안한 대로 훈련 가능한 부드러운 방사형 베셀 함수(SmoothRBF)에 의해 $\tilde{e}_{ij}$로 확장되었습니다. SmoothRBF는 방사형 베셀 함수와 그 도함수가 그래프 컷오프 반경에서 0에 접근하도록 강제하여 매끄러운 포텐셜 에너지 표면을 보장합니다. 각도 $\theta_{ijk}$는 푸리에 기저 함수에 의해 확장되어 훈련 가능한 주파수를 가진 $\tilde{a}_{ijk}$를 생성했습니다. 원자 번호 $Z_i$, $\tilde{e}_{ij}$, $\tilde{a}_{ijk}$는 노드 $v^0_i$, 엣지 $e^0_{ij}$, 각도 특징 $a^0_{ijk}$ (모두 기본적으로 64 특징 차원)로 임베딩되었습니다:

$$
\begin{aligned}
v^0_i &= Z_i \boldsymbol{W}_v + \boldsymbol{b}_v, \\
e^0_{ij,n} &= \tilde{e}_{ij} \boldsymbol{W}_e, \ \tilde{e}_{ij} = \sqrt{\frac{2}{5}} \frac{\sin(\frac{n\pi r_{ij}}{5})}{r_{ij}} \odot u(r_{ij}) \\
a^0_{ijk,\ell} &= \begin{cases}
\sqrt{\frac{1}{2\pi}} & \text{if } \ell = 0 \\
\sqrt{\frac{1}{\pi}} \cos{[\ell \theta_{ijk}]} & \text{if } \ell = [1, N] \\
\sqrt{\frac{1}{\pi}} \sin{[(\ell - N) \theta_{ijk}]} & \text{if } \ell = [N+1, 2N]
\end{cases},
\end{aligned} \quad (1)
$$

여기서 $\{\boldsymbol{W}, \boldsymbol{b}\}$는 훈련 가능한 가중치와 편향입니다. 각도는 $\theta_{ijk} = \arccos{\frac{e_{ij} \cdot e_{jk}}{|e_{ij}| |e_{jk}|}}$를 사용하여 계산됩니다. $u(r_{ij})$는 $\tilde{e}_{ij}$의 값, 1차 및 2차 도함수를 그래프 컷오프 반경에서 부드럽게 0으로 강제하는 다항식 포락선 함수입니다 [13]. 아래첨자 $n, \ell$은 확장 차수이며, $n$과 $\ell$ 모두에 대한 최대 차수를 $2N + 1 = 9$로 설정했습니다. 위첨자는 상호작용 블록의 인덱스를 나타냅니다. $\odot$은 요소별 곱셈을 나타냅니다. 엣지 벡터 $e^t_{ij}$는 양방향이며, 이는 $e^t_{ij}$와 $e^t_{ji}$가 결합 그래프에서 단일 노드로 표현되는 데 필수적입니다 [30].

결합 특징을 업데이트하기 위해 3체 구면 조화 함수 특징이 사용되는 M3GNet [18]과 같은 이전 GNN 모델과 달리, 우리는 원자 그래프와 결합 그래프에 미리 정의된 쌍별 연결을 통해 원자, 결합 및 각도 임베딩을 명시적으로 인코딩하고 업데이트합니다. 원자 그래프 합성곱의 경우, 두 원자와 하나의 결합에서 연결된(concatenated) 특징 벡터 $(v^t_i || v^t_j || e^t_{ij})$에 가중 메시지 전달 레이어가 적용됩니다.

<!-- Page 10 -->

결합 그래프 합성곱의 경우, 두 결합, 그 사이의 각도, 그리고 각도가 위치한 원자로부터 연결된 특징 벡터 $(e^t_{ij} || e^t_{jk} || a^t_{ijk} || v^{t+1}_j)$에 가중 메시지 전달 레이어가 적용됩니다. 각도 업데이트 함수의 경우, 결합 그래프 메시지 벡터와 동일한 구성을 사용했지만 가중 집계 단계는 제외했습니다. 원자, 결합 및 각도 업데이트의 수학적 형태는 다음과 같습니다:

$$
\begin{aligned}
v^{t+1}_i &= v^t_i + L^t_v \left[ \sum_j \tilde{e}_{ij} \cdot \phi^t_v \left( v^t_i || v^t_j || e^t_{ij} \right) \right], \\
e^{t+1}_{jk} &= e^t_{jk} + L^t_v \left[ \sum_i \tilde{e}_{ij} \cdot \tilde{e}_{jk} \cdot \phi^t_e \left( e^t_{ij} || e^t_{jk} || a^t_{ijk} || v^{t+1}_j \right) \right], \\
a^{t+1}_{ijk,f} &= a^t_{ijk} + \phi^t_a \left( e^{t+1}_{ij} || e^{t+1}_{jk} || a^t_{ijk} || v^{t+1}_j \right).
\end{aligned} \quad (2)
$$

$L$은 선형 레이어이고 $\phi$는 게이트 다층 퍼셉트론(gatedMLP) [29]입니다:

$$
\begin{aligned}
L(x) &= x\boldsymbol{W} + \boldsymbol{b}, \\
\phi(x) &= (\sigma \circ L_{\text{gate}}(x)) \odot (g \circ L_{\text{core}}(x)),
\end{aligned} \quad (3)
$$

여기서 $\sigma$와 $g$는 각각 `Sigmoid`와 `SiLU` 활성화 함수입니다. 자기 모멘트는 세 번의 상호작용 블록 후 원자 특징 $v^3_i$의 선형 투영에 의해 예측됩니다:

$$ m_i = L_m(v^3_i). \quad (4) $$

전체 상호작용 블록을 사용하는 대신, 마지막 합성곱 레이어는 원자 그래프 합성곱만 포함합니다.

$$ v^4_i = v^3_i + \sum_j \tilde{e}_{ij} \cdot \phi^3_v \left( v^3_i || v^3_j || e^3_{ij} \right). \quad (5) $$

에너지는 모든 원자 $\{v^4_i\}$에 대한 사이트별 평균 특징 벡터의 비선형 투영에 의해 계산됩니다. 힘과 응력은 원자 카르테시안 좌표 및 변형(strain)에 대한 에너지의 자동 미분을 통해 계산됩니다:

$$
\begin{aligned}
E_{\text{tot}} &= \sum_i L_3 \circ g \circ L_2 \circ g \circ L_1(v^4_i), \\
\vec{f}_i &= -\frac{\partial E_{\text{tot}}}{\partial \vec{x}_i}, \\
\sigma &= \frac{1}{V} \frac{\partial E_{\text{tot}}}{\partial \boldsymbol{\varepsilon}}.
\end{aligned} \quad (6)
$$

전반적으로 4개의 원자 합성곱 레이어를 통해 사전 학습된 CHGNet은 적은 계산 비용으로 최대 20Å까지의 장거리 상호작용을 포착할 수 있습니다.

### C. 모델 훈련 (Model training)

모델은 에너지, 힘, 응력 및 자기 모멘트의 Huber 손실($\delta = 0.1$)의 합을 최소화하도록 훈련됩니다:

$$
\mathcal{L}(x, \hat{x}) = \begin{cases}
0.5 \cdot (x - \hat{x})^2 & \text{if } |x - \hat{x}| < \delta \\
\delta \cdot (|x - \hat{x}| - 0.5\delta) & \text{otherwise}
\end{cases}. \quad (7)
$$

손실 함수는 에너지, 힘, 응력 및 자기 모멘트의 기여도의 가중 합입니다:

$$ \mathcal{L} = \mathcal{L}(E, \hat{E}) + w_f \mathcal{L}(\boldsymbol{f}, \hat{\boldsymbol{f}}) + w_\sigma \mathcal{L}(\boldsymbol{\sigma}, \hat{\boldsymbol{\sigma}}) + w_m \mathcal{L}(m, \hat{m}), \quad (8) $$

여기서 힘, 응력 및 자기 모멘트에 대한 가중치는 각각 $w_f = 1$, $w_\sigma = 0.1$, $w_m = 0.1$로 설정됩니다. DFT 에너지는 분산을 줄이기 위해 CHGNet에 피팅하기 전에 원소 참조 에너지로 정규화됩니다 [18]. 훈련에는 DFT 자기 모멘트의 절대값이 사용됩니다. 배치 크기는 40으로 설정되고 `Adam` 옵티마이저가 초기 학습률 $10^{-3}$으로 사용됩니다. `CosineAnnealingLR` 스케줄러는 에포크당 10번 학습률을 조정하는 데 사용되며, 최종 학습률은 20 에포크 후 $10^{-5}$로 감소합니다.

### D. 소프트웨어 인터페이스 (Software interface)

CHGNet은 `pytorch 1.12.0` [58]을 사용하여 구현되었으며, 결정 구조 처리는 `pymatgen` [59]을 사용했습니다. 분자 동역학 및 구조 이완은 `Atomic Simulation Environment (ASE)` [60] 인터페이스를 사용하여 시뮬레이션되었습니다. 클러스터 확장은 `smol` 패키지 [61]를 사용하여 수행되었습니다.

### E. 구조 이완 및 분자 동역학 (Structure relaxation and molecular dynamics)

모든 구조 이완은 CHGNet이 제공하는 포텐셜 에너지 표면에서 `FIRE` 옵티마이저에 의해 최적화되었으며 [62], 여기서 원자 위치, 셀 모양 및 셀 부피는 0.1 eV/Å의 수렴된 원자 간 힘에 도달하도록 동시에 최적화되었습니다.

$o$-LMO에서 $s$-LMO로의 상전이 MD 시뮬레이션을 위해, 초기 구조 $\text{Li}_{20}\text{Mn}_{40}\text{O}_{80}$은 사방정계 구조의 $\text{Li}_{40}\text{Mn}_{40}\text{O}_{80}$ 슈퍼셀에서 Li를 무작위로 제거하고 DFT로 이완하여 생성되었습니다. MD 시뮬레이션은 NVT 앙상블 하에서 2 fs의 시간 단계로 $T = 1100$ K에서 1.5 ns 동안 실행되었습니다. 그림 4(b)의 시뮬레이션된 XRD의 경우, 0.0, 0.3, 0.6, 0.9, 1.2, 1.5 ns의 구조를 가장 가까운 Wyckoff 위치로 조립(coarse-grained)하여 노이즈 피크를 제거했습니다. 그림 4(c)에서 $\text{Mn}_{\text{oct}}$와 $\text{Mn}_{\text{tet}}$는 2.52 Å 이내의 결합 산소 이온 수를 세어 결정했습니다. 6개의 결합 산소 이온이 발견되면 Mn 이온은 $\text{Mn}_{\text{oct}}$로 분류되고, 6개 미만의 결합 산소 이온이 발견되면 Mn 이온은 더 낮은 배위 환경을 나타내기 위해 $\text{Mn}_{\text{tet}}$로 조립됩니다. 그림 4(e)에서 $\text{Mn}^{2+}$와 $\text{Mn}^{3+}$는 $4.2 \mu_B$의 CHGNet 자기 모멘트 임계값으로 분류됩니다 [38].

가넷 $\text{Li}_3\text{La}_3\text{Te}_2\text{O}_{12}$ 시스템의 MD 시뮬레이션의 경우 2 fs의 시간 단계가 사용되었습니다. 우리는 온도를

<!-- Page 11 -->

NVT 앙상블에서 목표 온도까지 최소 1 ps 동안 상승시켰습니다. 그런 다음 50 ps 동안 시스템을 평형화한 후, 최소 2.3 ns 동안 궤적의 평균 제곱 변위(mean squared displacements)를 계산하여 리튬 자기 확산 계수를 얻었습니다. 확산 계수 값의 불확실성 분석은 He 등 [63]이 제안한 경험적 오차 추정 방식을 따랐습니다. $\text{Li}_{3+\delta}$에서 과잉 리튬은 완전히 점유된 $24d$ 사면체 사이트와 면을 공유하도록 중간 팔면체($48g$) 사이트에 채워졌습니다.

### F. 상 다이어그램 계산 (Phase diagram calculations)

$\text{Li}_x\text{FePO}_4$의 클러스터 확장(CE)은 $\text{LiFePO}_4$의 이완된 단위 셀을 기반으로 최대 11 Å의 쌍 상호작용과 최대 7 Å의 삼중 상호작용으로 수행되었습니다. 더 나은 에너지 정확도를 위해 먼저 Li-Fe-P-O 화학 공간의 Materials Project 구조로 CHGNet을 미세 조정(fine-tuned)하여 테스트 오차를 23 meV/atom에서 15 meV/atom으로 줄였습니다 (보충 정보 참조). 우리는 CHGNet을 적용하여 $\text{Li}_x\text{FePO}_4$ ($0 \le x \le 1$)의 456개 서로 다른 구조를 이완하고 에너지와 자기 모멘트를 예측했습니다. 여기서 456개 구조는 CE 피팅, 기저 상태 탐색을 위한 정준(canonical) CE 몬테카를로, 다양한 $\text{Li}^+$ 조성 및 CHGNet 이완을 포함하는 자동 워크플로를 통해 생성되었습니다. 전하 장식 CE는 $\text{Li}^+$/공공 및 $\text{Fe}^{2+}$/$\text{Fe}^{3+}$ 사이트에 대한 결합된 부격자(sublattices)에 정의되며, 여기서 $\text{Fe}^{2+}$와 $\text{Fe}^{3+}$는 서로 다른 종으로 취급됩니다. 또한 비전하 장식 CE는 $\text{Li}^+$/공공 사이트에만 정의됩니다. 전하 장식 CE에서 $\text{Fe}^{2+}$/$\text{Fe}^{3+}$는 각각 $[3\mu_B, 4\mu_B]$ 및 $[4\mu_B, 5\mu_B]$의 자기 모멘트로 분류됩니다 [38].

준-대정준 몬테카를로 시뮬레이션은 Metropolis-Hastings 알고리즘을 사용하여 구현되었으며, 여기서 MC 단계의 20%는 정준적으로($\text{Li}^+$/공공 또는 $\text{Fe}^{2+}$/$\text{Fe}^{3+}$ 교환), MC 단계의 80%는 테이블 교환 방법 [64, 65]을 사용하여 대정준적으로 구현되었습니다. 시뮬레이션은 $\text{LiFePO}_4$ 단위 셀의 $8 \times 6 \times 4$에서 구현되었습니다. 각 MC 시뮬레이션에서 우리는 $[-5.6, -4.8]$ 범위의 화학 포텐셜을 0.01 단계로 스캔하고 0에서 1000 K까지의 온도를 샘플링했습니다. 고용체 안정상의 경계는 $\Delta\mu = 0.01$ eV에 의한 Li 농도 차이 < 0.05로 결정됩니다.

구성 및 전자 엔트로피의 효과는 Ref. [47]에 설명된 대로 $S(\text{Li}, e) = S'(\text{Li}) + S'(e) + I(\text{Li}, e)$를 통해 조사할 수 있습니다. $S'$는 고정된 Y($e$ 또는 Li)가 주어졌을 때 X(Li 또는 $e$) 자유도의 조건부 엔트로피 $S(X|Y)$를 나타내며, $I(\text{Li}, e)$는 두 자유도의 상호 정보를 나타냅니다. $S'(e/\text{Li})$는 $\text{Li}$/공공 또는 $\text{Fe}^{2+}$/$\text{Fe}^{3+}$ 정렬의 고정된 구성을 가진 정준 MC로부터 얻을 수 있습니다. 이 작업은 클러스터 확장에 전하 장식 자유도를 명시적으로 통합함으로써 용이해지며, 이는 CHGNet에서 파생된 원자 전하 추론에 의해 입증된 필요성입니다.

### G. DFT 계산 (DFT calculations)

DFT 계산은 Vienna *ab initio simulation package* (VASP)를 사용하여 수행되었으며, 프로젝터 증강 파동(projector-augmented wave) 방법 [66, 67], 520 eV의 에너지 컷오프를 가진 평면파 기저 세트, Å$^{-1}$당 25 k-포인트의 역공간 이산화를 사용했습니다. 모든 계산은 전자 루프의 경우 총 에너지 $10^{-6}$ eV, 이온 루프의 경우 원자 간 힘 0.02 eV/Å로 수렴되었습니다. 우리는 전이 금속 원자의 자기 상호작용 오차를 보상하기 위해 회전 평균 Hubbard U 보정(GGA+$U$)이 포함된 Perdew–Burke–Ernzerhof (PBE) 일반화 구배 근사 교환-상관 범함수 [68]를 사용했습니다 (Mn의 경우 3.9 eV) [69].

## VI. 가용성 (AVAILABILITY)

### A. 코드 가용성 (Code availability)

MPtrj 데이터셋에 대한 CHGNet의 소스 코드, 사전 학습된 가중치 및 예제 노트북은 https://github.com/CederGroupHub/chgnet 에서 확인할 수 있습니다.

### B. 데이터 가용성 (Data availability)

데이터셋은 검토 후 공개될 예정입니다.

## VII. 경쟁 이익 (COMPETING INTERESTS)

저자들은 경쟁 이익이 없음을 선언합니다.

---
<!-- References are kept in original language as per standard academic translation practices -->
[1] D. Frenkel and B. Smit, *Understanding molecular simulation: from algorithms to applications*, Vol. 1 (Elsevier, 2001).
[2] T. R. Lucas, B. A. Bauer, and S. Patel, Charge equilibration force fields for molecular dynamics simulations of lipids, bilayers, and integral membrane protein systems, Biochimica et Biophysica Acta (BBA) - Biomembranes **1818**, 318–329 (2012).
[3] R. Drautz, Atomic cluster expansion of scalar, vectorial, and tensorial properties including magnetism and charge transfer, Physical Review B **102**, 024104 (2020).
[4] W. J. Mortier, S. K. Ghosh, and S. Shankar, Electronegativity-equalization method for the calculation of atomic charges in molecules, Journal of the American

<!-- Page 12 -->

Chemical Society **108**, 4315–4320 (1986).
[5] D. M. York and W. Yang, A chemical potential equalization method for molecular simulations, The Journal of Chemical Physics **104**, 159–172 (1996).
[6] A. K. Rappe and W. A. Goddard, Charge equilibration for molecular dynamics simulations, The Journal of Physical Chemistry **95**, 3358–3363 (1991).
[7] W. Kohn and L. J. Sham, Self-consistent equations including exchange and correlation effects, Physical Review **140**, A1133 (1965).
[8] J. Reed and G. Ceder, Role of electronic structure in the susceptibility of metastable transition-metal oxide structures to transformation, Chemical Reviews **104**, 4513 (2004).
[9] D. Eum, B. Kim, S. J. Kim, H. Park, J. Wu, S.-P. Cho, G. Yoon, M. H. Lee, S.-K. Jung, W. Yang, W. M. Seong, K. Ku, O. Tamwattana, S. K. Park, I. Hwang, and K. Kang, Voltage decay and redox asymmetry mitigation by reversible cation migration in lithium-rich layered oxide electrodes, Nature Materials **19**, 419 (2020).
[10] N. Artrith, T. Morawietz, and J. Behler, High-dimensional neural-network potentials for multicomponent systems: Applications to zinc oxide, Physical Review B **83**, 153101 (2011).
[11] J. Lopez-Zorrilla, X. M. Aretxabaleta, I. Yue, I. Etxebarria, H. Manzano, and N. Artrith, ænet-PyTorch: a GPU-supported implementation for machine learning atomic potentials training, arXiv preprint arXiv:2302.09406 (2023).
[12] L. Zhang, H. Wang, R. Car, and W. E, Phase Diagram of a Deep Potential Water Model, Physical Review Letters **126**, 236001 (2021).
[13] J. Gasteiger, J. Groß, and S. Günnemann, Directional message passing for molecular graphs, in *International Conference on Learning Representations (ICLR)* (2020).
[14] S. Batzner, A. Musaelian, L. Sun, M. Geiger, J. P. Mailoa, M. Kornbluth, N. Molinari, T. E. Smidt, and B. Kozinsky, E(3)-equivariant graph neural networks for data-efficient and accurate interatomic potentials, Nature Communications **13**, 2453 (2022).
[15] S. Takamoto, S. Izumi, and J. Li, Teanet: Universal neural network interatomic potential inspired by iterative electronic relaxations, Computational Materials Science **207**, 111280 (2022).
[16] I. Batatia, D. P. Kovacs, G. N. C. Simm, C. Ortner, and G. Csanyi, MACE: Higher order equivariant message passing neural networks for fast and accurate force fields, in *Advances in Neural Information Processing Systems*, edited by A. H. Oh, A. Agarwal, D. Belgrave, and K. Cho (2022).
[17] X. Fu, Z. Wu, W. Wang, T. Xie, S. Keten, R. Gomez-Bombarelli, and T. Jaakkola, Forces are not Enough: Benchmark and Critical Evaluation for Machine Learning Force Fields with Molecular Simulations, arXiv preprint arXiv:2210.07237 (2022).
[18] C. Chen and S. P. Ong, A universal graph deep learning interatomic potential for the periodic table, Nature Computational Science **2**, 718–728 (2022).
[19] K. Choudhary, B. DeCost, L. Major, K. Butler, J. Thiyagalingam, and F. Tavazza, Unified graph neural network force-field for the periodic table: solid state applications, Digital Discovery (2023).
[20] S. Takamoto, C. Shinagawa, D. Motoki, K. Nakago, W. Li, I. Kurata, T. Watanabe, Y. Yayama, H. Iriguchi, Y. Asano, T. Onodera, T. Ishii, T. Kudo, H. Ono, R. Sawada, R. Ishitani, M. Ong, T. Yamaguchi, T. Kataoka, A. Hayashi, N. Charoenphakdee, and T. Ibuka, Towards universal neural network potential for material discovery applicable to arbitrary combination of 45 elements, Nature Communications **13**, 2991 (2022).
[21] O. T. Unke, S. Chmiela, M. Gastegger, K. T. Schütt, H. E. Sauceda, and K.-R. Müller, Spookynet: Learning force fields with electronic degrees of freedom and nonlocal effects, Nature Communications **12**, 7273 (2021).
[22] T. W. Ko, J. A. Finkler, S. Goedecker, and J. Behler, A fourth-generation high-dimensional neural network potential with accurate electrostatics including non-local charge transfer, Nature Communications **12**, 398 (2021).
[23] R. Zubatyuk, J. S. Smith, B. T. Nebgen, S. Tretiak, and O. Isayev, Teaching a neural network to attach and detach electrons from molecules, Nature Communications **12**, 4870 (2021).
[24] A. Walsh, A. A. Sokol, J. Buckeridge, D. O. Scanlon, and C. R. A. Catlow, Oxidation states and ionicity, Nature Materials **17**, 958 (2018).
[25] X. Xie, K. A. Persson, and D. W. Small, Incorporating electronic information into machine learning potential energy surfaces via approaching the ground-state electronic energy as a function of atom-based electronic populations, Journal of Chemical Theory and Computation **16**, 4256–4270 (2020).
[26] S. Gong, T. Xie, T. Zhu, S. Wang, E. R. Fadel, Y. Li, and J. C. Grossman, Predicting charge density distribution of materials using a local-environment-based graph convolutional network, Physical Review B **100**, 184103 (2019).
[27] J. Bruna, W. Zaremba, A. Szlam, and Y. LeCun, Spectral networks and locally connected networks on graphs, arXiv preprint arXiv:1312.6203 (2013).
[28] M. Geiger and T. Smidt, e3nn: Euclidean neural networks, arXiv preprint arXiv:2207.09453 (2022).
[29] T. Xie and J. C. Grossman, Crystal graph convolutional neural networks for an accurate and interpretable prediction of material properties, Physical Review Letters **120**, 145301 (2018).
[30] K. Choudhary and B. DeCost, Atomistic line graph neural network for improved materials property predictions, npj Computational Materials **7**, 185 (2021).
[31] A. Jain, S. P. Ong, G. Hautier, W. Chen, W. D. Richards, S. Dacek, S. Cholia, D. Gunter, D. Skinner, G. Ceder, and K. A. Persson, Commentary: The Materials Project: A materials genome approach to accelerating materials innovation, APL Materials **1**, 011002 (2013).
[32] A. Wang, R. Kingsbury, M. McDermott, M. Horton, A. Jain, S. P. Ong, S. Dwaraknath, and K. A. Persson, A framework for quantifying uncertainty in DFT energy corrections, Scientific Reports **11**, 15496 (2021).
[33] J. Riebesell, Rhy. Goodall, A. Jain, K. Persson, A. Lee, Matbench Discovery: Can machine learning identify stable crystals? https://matbench-discovery.materialsproject.org.
[34] K. Jun, Y. Sun, Y. Xiao, Y. Zeng, R. Kim, H. Kim, L. J. Miara, D. Im, Y. Wang, and G. Ceder, Lithium superionic conductors with corner-sharing frameworks, Nature Materials **21**, 924–931 (2022).
[35] W. Mackrodt, N. Harrison, V. Saunders, N. Allan, and M. Towler, Direct evidence of O(p) holes in Li-doped NiO from Hartree-Fock calculations, Chemical Physics Letters

<!-- Page 13 -->

**250**, 66 (1996).
[36] C. Wolverton and A. Zunger, First-principles prediction of vacancy order-disorder and intercalation battery voltages in Li$_x$CoO$_2$, Physical Review Letters **81**, 606 (1998).
[37] Z. Qiao, A. S. Christensen, M. Welborn, F. R. Manby, A. Anandkumar, and T. F. Miller, Informing geometric deep learning with electronic interactions to accelerate quantum chemistry, Proceedings of the National Academy of Sciences **119**, 1 (2022).
[38] L. Barroso-Luque, P. Zhong, J. H. Yang, F. Xie, T. Chen, B. Ouyang, and G. Ceder, Cluster expansions of multicomponent ionic materials: Formalism and methodology, Physical Review B **106**, 144202 (2022).
[39] Z. Wang, S. Park, Z. Deng, D. Carlier, J.-N. Chotard, L. Croguennec, G. S. Gautam, A. K. Cheetham, C. Masquelier, and P. Canepa, Phase stability and sodium-vacancy orderings in a NaSICON electrode, Journal of Materials Chemistry A **10**, 209 (2022).
[40] J. Reed, G. Ceder, and A. V. D. Ven, Layered-to-Spinel Phase Transition in Li$_x$MnO$_2$, Electrochemical and Solid-State Letters **4**, A78 (2001).
[41] K. Kang and G. Ceder, Factors that affect Li mobility in layered lithium transition metal oxides, Physical Review B **74**, 094105 (2006).
[42] J. N. Reimers, E. W. Fuller, E. Rossen, and J. R. Dahn, Synthesis and Electrochemical Studies of LiMnO$_2$ Prepared at Low Temperatures, Journal of The Electrochemical Society **140**, 3396–3401 (1993).
[43] I. Koetschau, M. N. Richard, J. R. Dahn, J. B. Soupart, and J. C. Rousche, Orthorhombic LiMnO$_2$ as a High Capacity Cathode for Li-Ion Cells, Journal of The Electrochemical Society **142**, 2906–2910 (1995).
[44] Y.-I. Jang, F. Chou, B. Huang, D. R. Sadoway, and Y.-M. Chiang, Magnetic characterization of orthorhombic LiMnO$_2$ and electrochemically transformed spinel Li$_x$MnO$_2$ ($x < 1$), Journal of Physics and Chemistry of Solids **64**, 2525–2533 (2003).
[45] M. R. Jo, Y. Kim, J. Yang, M. Jeong, K. Song, Y.-I. Kim, J.-M. Lim, M. Cho, J.-H. Shim, Y.-M. Kim, W.-S. Yoon, and Y.-M. Kang, Triggered reversible phase transformation between layered and spinel structure in manganese-based layered compounds, Nature Communications **10**, 3385 (2019).
[46] M. D. Radin, J. Vinckeviciute, R. Seshadri, and A. Van der Ven, Manganese oxidation as the origin of the anomalous capacity of Mn-containing Li-excess cathode materials, Nature Energy **4**, 639 (2019).
[47] F. Zhou, T. Maxisch, and G. Ceder, Configurational Electronic Entropy and the Phase Diagram of Mixed-Valence Oxides: The Case of Li$_x$FePO$_4$, Physical Review Letters **97**, 155704 (2006).
[48] A. Walle and G. Ceder, Automating first-principles phase diagram calculations, Journal of Phase Equilibria **23**, 348 (2002).
[49] C. Delacourt, P. Poizot, J.-M. Tarascon, and C. Masquelier, The existence of a temperature-driven solid solution in Li$_x$FePO$_4$ for $0 \le x \le 1$, Nature Materials **4**, 254–260 (2005).
[50] J. L. Dodd, R. Yazami, and B. Fultz, Phase Diagram of Li$_x$FePO$_4$, Electrochemical and Solid-State Letters **9**, A151 (2006).
[51] Y. Xiao, K. Jun, Y. Wang, L. J. Miara, Q. Tu, and G. Ceder, Lithium Oxide Superionic Conductors Inspired by Garnet and NASICON Structures, Advanced Energy Materials **11**, 2101437 (2021).
[52] J. Huang, L. Zhang, H. Wang, J. Zhao, J. Cheng, and W. E, Deep potential generation scheme and simulation protocol for the Li$_{10}$GeP$_2$S$_{12}$-type superionic conductors, The Journal of Chemical Physics **154**, 094703 (2021).
[53] Z. Lun, B. Ouyang, D.-h. Kwon, Y. Ha, E. E. Foley, T.-Y. Huang, Z. Cai, H. Kim, M. Balasubramanian, Y. Sun, J. Huang, Y. Tian, H. Kim, B. D. McCloskey, W. Yang, R. J. Clément, H. Ji, and G. Ceder, Cation-disordered rocksalt-type high-entropy cathodes for Li-ion batteries, Nature Materials **20**, 214 (2021).
[54] Y. Sun and S. Dai, High-entropy materials for catalysis: A new frontier, Science Advances **7**, 1 (2021).
[55] B. Silvi and A. Savin, Classification of chemical bonds based on topological analysis of electron localization functions, Nature **371**, 683 (1994).
[56] R. King-Smith and D. Vanderbilt, Theory of polarization of crystalline solids, Physical Review B **47**, 1651 (1993).
[57] L. Zhang, H. Wang, M. C. Muniz, A. Z. Panagiotopoulos, R. Car, and W. E, A deep potential model with long-range electrostatic interactions, The Journal of Chemical Physics **156**, 124107 (2022).
[58] A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen, Z. Lin, N. Gimelshein, L. Antiga, *et al.*, Pytorch: An imperative style, high-performance deep learning library, Advances in neural information processing systems **32** (2019).
[59] S. P. Ong, W. D. Richards, A. Jain, G. Hautier, M. Kocher, S. Cholia, D. Gunter, V. L. Chevrier, K. A. Persson, and G. Ceder, Python Materials Genomics (pymatgen): A robust, open-source python library for materials analysis, Computational Materials Science **68**, 314 (2013).
[60] A. H. Larsen, J. J. Mortensen, J. Blomqvist, I. E. Castelli, R. Christensen, M. Dulak, J. Friis, M. N. Groves, B. Hammer, C. Hargus, *et al.*, The atomic simulation environment—a Python library for working with atoms, Journal of Physics: Condensed Matter **29**, 273002 (2017).
[61] L. Barroso-Luque, J. H. Yang, F. Xie, T. Chen, R. L. Kam, Z. Jadidi, P. Zhong, and G. Ceder, smol: A Python package for cluster expansions and beyond, Journal of Open Source Software **7**, 4504 (2022).
[62] E. Bitzek, P. Koskinen, F. Gähler, M. Moseler, and P. Gumbsch, Structural relaxation made simple, Physical Review Letters **97**, 1 (2006).
[63] X. He, Y. Zhu, A. Epstein, and Y. Mo, Statistical variances of diffusional properties from ab initio molecular dynamics simulations, npj Computational Materials **4**, 18 (2018).
[64] F. Xie, P. Zhong, L. Barroso-Luque, B. Ouyang, and G. Ceder, Semigrand-canonical Monte-Carlo simulation methods for charge-decorated cluster expansions, Computational Materials Science **218**, 112000 (2023).
[65] Z. Deng, G. Sai Gautam, S. K. Kolli, J.-N. Chotard, A. K. Cheetham, C. Masquelier, and P. Canepa, Phase Behavior in Rhombohedral NaSiCON Electrolytes and Electrodes, Chemistry of Materials **32**, 7908 (2020).
[66] G. Kresse and J. Furthmüller, Efficiency of ab-initio total energy calculations for metals and semiconductors using a plane-wave basis set, Computational Materials Science **6**, 15 (1996).
[67] G. Kresse and D. Joubert, From ultrasoft pseudopotentials to the projector augmented-wave method, Physical

<!-- Page 14 -->

Review B **59**, 1758 (1999).
[68] J. P. Perdew, K. Burke, and M. Ernzerhof, Generalized Gradient Approximation Made Simple, Physical Review Letters **77**, 3865 (1996).
[69] L. Wang, T. Maxisch, and G. Ceder, Oxidation energies of transition metal oxides within the GGA+U framework, Physical Review B **73**, 195107 (2006).
